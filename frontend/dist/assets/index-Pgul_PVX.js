const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/monthly-DqeYW1a1.js","assets/react-vendor-DtX1tuCI.js"])))=>i.map(i=>d[i]);
import{g as e,a as t,j as a,h as s}from"./monthly-DqeYW1a1.js";import{a as n,r as l,R as o}from"./react-vendor-DtX1tuCI.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var i={},r=n;i.createRoot=r.createRoot,i.hydrateRoot=r.hydrateRoot;const c={};const d=new Map;function u({event:e,categories:t,onUpdate:s,onDelete:n,onClose:o}){const i=null===e.id,[r,c]=l.useState(e.title||""),[d,u]=l.useState(e.start_time||(e.start?e.start.split("T")[1].substring(0,5):"")),[m,p]=l.useState(e.end_time||(e.end?e.end.split("T")[1].substring(0,5):"")),[h,x]=l.useState(e.category_id),[g,v]=l.useState(e.description||""),[f,j]=l.useState(e.is_plan||!1);e.is_plan;return a.jsx("div",{className:"modal-overlay",onClick:o,children:a.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[a.jsx("h2",{children:i?"ì´ë²¤íŠ¸ ì¶”ê°€":"ì´ë²¤íŠ¸ ìˆ˜ì •"}),a.jsxs("form",{onSubmit:t=>{t.preventDefault();const a=5===d.length?`${d}:00`:d,n=5===m.length?`${m}:00`:m;s(e.id,{title:r,start_time:a,end_time:n,category_id:h,description:g,is_plan:f})},children:[a.jsxs("div",{className:"modal-scroll-content",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì œëª©"}),a.jsx("input",{type:"text",value:r,onChange:e=>c(e.target.value),placeholder:"ì´ë²¤íŠ¸ ì œëª©",required:!0})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì‹œìž‘ ì‹œê°„"}),a.jsx("input",{type:"time",value:d,onChange:e=>u(e.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì¢…ë£Œ ì‹œê°„"}),a.jsx("input",{type:"time",value:m,onChange:e=>p(e.target.value),required:!0})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì¹´í…Œê³ ë¦¬"}),a.jsx("select",{value:h,onChange:e=>x(parseInt(e.target.value)),children:t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))})]}),a.jsx("div",{className:"form-group checkbox-group",children:a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:f,onChange:e=>j(e.target.checked)}),a.jsx("span",{className:"checkbox-text",children:"ê³„íš ì´ë²¤íŠ¸ë¡œ ì¶”ê°€"})]})}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì„¤ëª…"}),a.jsx("textarea",{value:g,onChange:e=>v(e.target.value),placeholder:"ì´ë²¤íŠ¸ ì„¤ëª… (ì„ íƒì‚¬í•­)",rows:3})]})]}),a.jsxs("div",{className:"modal-actions",children:[!i&&a.jsx("button",{type:"button",className:"btn-delete",onClick:()=>{window.confirm("ì´ ì´ë²¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&n(e.id)},children:"ì‚­ì œ"}),a.jsxs("div",{className:"modal-actions-right",children:[a.jsx("button",{type:"button",className:"btn-cancel",onClick:o,children:"ì·¨ì†Œ"}),a.jsx("button",{type:"submit",className:"btn-submit",children:i?"ì¶”ê°€":"ì €ìž¥"})]})]})]})]})})}function m({event:e,categories:t,position:s,onUpdate:n,onDelete:o,onClose:i}){const[r,c]=l.useState(e.title),[d,u]=l.useState(e.date||e.start.split("T")[0]),[m,p]=l.useState(e.start_time||e.start.split("T")[1].substring(0,5)),[h,x]=l.useState(e.date||e.end.split("T")[0]),[g,v]=l.useState(e.end_time||e.end.split("T")[1].substring(0,5)),[f,j]=l.useState(e.category_id),y=l.useRef(null);l.useEffect(()=>{var e;const t=null==(e=y.current)?void 0:e.querySelector('input[type="text"]');t&&(t.focus(),t.select())},[]),l.useEffect(()=>{const e=e=>{y.current&&!y.current.contains(e.target)&&b()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[r,d,m,h,g,f]);const b=()=>{const t=5===m.length?`${m}:00`:m,a=5===g.length?`${g}:00`:g;n(e.id,{title:r,start_time:t,end_time:a,date:d,category_id:f})};return a.jsxs("div",{ref:y,className:"event-edit-popup",style:{position:"absolute",left:`${s.x}px`,top:`${s.y}px`},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),b()):"Escape"===e.key&&i()},children:[a.jsx("div",{className:"popup-row",children:a.jsx("input",{type:"text",value:r,onChange:e=>c(e.target.value),placeholder:"ì´ë²¤íŠ¸ ì œëª©",className:"popup-title-input"})}),a.jsxs("div",{className:"popup-row time-row",children:[a.jsx("label",{style:{fontSize:"12px",color:"#666",width:"30px"},children:"ì‹œìž‘"}),a.jsx("input",{type:"date",value:d,onChange:e=>u(e.target.value),className:"popup-time-input",style:{flex:1.5}}),a.jsx("input",{type:"time",value:m,onChange:e=>p(e.target.value),className:"popup-time-input"})]}),a.jsxs("div",{className:"popup-row time-row",children:[a.jsx("label",{style:{fontSize:"12px",color:"#666",width:"30px"},children:"ì¢…ë£Œ"}),a.jsx("input",{type:"date",value:h,onChange:e=>x(e.target.value),className:"popup-time-input",style:{flex:1.5}}),a.jsx("input",{type:"time",value:g,onChange:e=>v(e.target.value),className:"popup-time-input"})]}),a.jsx("div",{className:"popup-row",children:a.jsx("select",{value:f,onChange:e=>j(parseInt(e.target.value)),className:"popup-category-select",children:t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))})}),a.jsxs("div",{className:"popup-actions",children:[a.jsx("button",{onClick:()=>{window.confirm("ì´ ì´ë²¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&o(e.id)},className:"popup-btn-delete",children:"ì‚­ì œ"}),a.jsx("button",{onClick:b,className:"popup-btn-save",children:"ì €ìž¥"})]})]})}function p({events:t,todos:n,categories:o,todoCategories:i,loading:r,currentDate:c,onCreateEvent:d,onUpdateEvent:p,onDeleteEvent:h,wakeSleepInfo:x}){const g=40,[v,f]=l.useState(!1),[j,y]=l.useState(null),[b,N]=l.useState(null),[S,C]=l.useState(null),[k,w]=l.useState(null),[T,D]=l.useState(!1),[_,E]=l.useState(!1),[$,I]=l.useState({x:0,y:0}),[M,R]=l.useState(!1),[P,z]=l.useState(null),[A,F]=l.useState(0),[L,B]=l.useState(null),[q,Y]=l.useState(null),[O,U]=l.useState(!1),[W,H]=l.useState(null),[K,X]=l.useState(null),[V,G]=l.useState(null),[Q,Z]=l.useState(null),[J,ee]=l.useState(null),te=l.useRef(null),ae=l.useRef(null),se=l.useRef(null),ne=l.useRef(null),le=l.useRef(null),[oe,ie]=l.useState(new Date);l.useEffect(()=>{const e=setInterval(()=>{ie(new Date)},6e4);return()=>clearInterval(e)},[]),l.useEffect(()=>{const e=e=>t=>{const a=document.getElementById(`timeline-hover-line-${e}`),s=te.current;if(!a||!s)return;const n=s.getBoundingClientRect(),l=t.clientY-n.top+s.scrollTop;a.style.top=l+"px",a.style.display="block"},t=e=>()=>{const t=document.getElementById(`timeline-hover-line-${e}`);t&&(t.style.display="none")},a=setTimeout(()=>{const a=document.querySelector(".plan-column"),s=document.querySelector(".actual-column");a&&(a.addEventListener("mousemove",e("plan")),a.addEventListener("mouseleave",t("plan"))),s&&(s.addEventListener("mousemove",e("actual")),s.addEventListener("mouseleave",t("actual")))},100);return()=>{clearTimeout(a);const s=document.querySelector(".plan-column"),n=document.querySelector(".actual-column");s&&(s.removeEventListener("mousemove",e("plan")),s.removeEventListener("mouseleave",t("plan"))),n&&(n.removeEventListener("mousemove",e("actual")),n.removeEventListener("mouseleave",t("actual")))}},[t,r]);const re=e=>e.touches&&e.touches.length>0?{clientY:e.touches[0].clientY}:e.changedTouches&&e.changedTouches.length>0?{clientY:e.changedTouches[0].clientY}:{clientY:e.clientY},ce=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,de=()=>{const e=new Date,t=e.getHours(),a=10*Math.floor(e.getMinutes()/10),s=`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`,n=`${String(t).padStart(2,"0")}:${String(a+30).padStart(2,"0")}`;w({id:null,title:"",start_time:s,end_time:n,category_id:o.length>0?o[0].id:null,description:"",is_plan:!1}),D(!0)},ue=(t,a)=>{if(ce())return;if(O)return;t.stopPropagation(),t.preventDefault(),E(!1),D(!1),w(null);const s=te.current.getBoundingClientRect(),{clientY:n}=re(t),l=n-s.top,o=e(c),[i,r]=a.start.split("T"),[d,u]=r.split(":").map(Number),m=new Date(a.start),p=new Date(a.end),h=Math.round((p-m)/6e4);let x;if(i<o)x=0;else{if(i>o)return;x=60*d+u}const v=l-x/60*g;R(!0),z(a),F(v),B(x),Y(h)},me=(t,a,s)=>{if(ce())return;t.stopPropagation(),t.preventDefault(),E(!1),D(!1),w(null);const n=e(c),[l,o]=a.start.split("T"),[i,r]=a.end.split("T"),[d,u]=o.split(":").map(Number),[m,p]=r.split(":").map(Number);let h,x;if(l<n)h=0;else{if(l>n)return;h=60*d+u}if(i>n)x=1440+(60*m+p);else{if(i<n)return;x=60*m+p}U(!0),H(s),X(a),G(h),Z(x),R(!1),z(null)},pe=(e,t)=>{if(ce())return;if(e.target.closest(".event-block-absolute"))return;const a=te.current.getBoundingClientRect(),{clientY:s}=re(e),n=s-a.top,l=Math.floor(n/g*60),o=10*Math.round(l/10);f(!0),y(t),N(o),C(o)},he=l.useCallback(e=>O?(le.current&&cancelAnimationFrame(le.current),void(le.current=requestAnimationFrame(()=>{const t=te.current.getBoundingClientRect(),{clientY:a}=re(e),s=a-t.top,n=Math.floor(s/g*60),l=10*Math.round(n/10),o=Math.max(0,Math.min(2880,l));if("top"===W){if(o<Q-10){G(o);const t=Math.floor(o/60),a=o%60,s=Math.floor(Q/60),n=Q%60,l=`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`,i=`${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}`;ee({x:e.clientX||e.touches&&e.touches[0].clientX,y:e.clientY||e.touches&&e.touches[0].clientY,startTime:l,endTime:i})}}else if("bottom"===W&&o>V+10){Z(o);const t=Math.floor(V/60),a=V%60,s=Math.floor(o/60),n=o%60,l=`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`,i=`${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}`;ee({x:e.clientX||e.touches&&e.touches[0].clientX,y:e.clientY||e.touches&&e.touches[0].clientY,startTime:l,endTime:i})}}))):M?(ne.current&&cancelAnimationFrame(ne.current),void(ne.current=requestAnimationFrame(()=>{const t=te.current.getBoundingClientRect(),{clientY:a}=re(e),s=a-t.top,n=Math.floor((s-A)/g*60),l=10*Math.round(n/10),o=Math.max(0,l);if(L!==o){B(o);const t=o+q,a=Math.floor(o/60),s=o%60,n=Math.floor(t/60),l=t%60,i=`${String(a).padStart(2,"0")}:${String(s).padStart(2,"0")}`,r=`${String(n).padStart(2,"0")}:${String(l).padStart(2,"0")}`;ee({x:e.clientX||e.touches&&e.touches[0].clientX,y:e.clientY||e.touches&&e.touches[0].clientY,startTime:i,endTime:r})}}))):void(v&&(ae.current&&cancelAnimationFrame(ae.current),ae.current=requestAnimationFrame(()=>{const t=te.current.getBoundingClientRect(),{clientY:a}=re(e),s=a-t.top,n=Math.floor(s/g*60),l=10*Math.round(n/10);se.current!==l&&(se.current=l,C(l))}))),[v,M,O,W,V,Q,g,A,L,q]),xe=l.useCallback(async()=>{if(ee(null),O&&K){le.current&&(cancelAnimationFrame(le.current),le.current=null);const t=e(c),[a,s]=K.start.split("T"),[n,l]=K.end.split("T");let o={};if("top"===W){let e=Math.floor(V/60),a=V%60,s=t;if(V<0)return U(!1),H(null),X(null),G(null),void Z(null);o={start_time:`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}:00`,date:s}}else if("bottom"===W){let e=Math.floor(Q/60),t=Q%60;Q>=1440&&(e=Math.floor(Q/60)-24,t=Q%60);o={end_time:`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}:00`}}try{await p(K.id,o)}catch(k){}return U(!1),H(null),X(null),G(null),void Z(null)}if(M&&P){ne.current&&(cancelAnimationFrame(ne.current),ne.current=null);const t=e(c),[a]=P.start.split("T"),s=L,n=s+q;if(s<0)return R(!1),z(null),B(null),void Y(null);let l=e(c),o=Math.floor(s/60),i=s%60,r=Math.floor(n/60),d=n%60;n>=1440&&(r=Math.floor(n/60)-24,d=n%60);const u=`${String(o).padStart(2,"0")}:${String(i).padStart(2,"0")}:00`,m=`${String(r).padStart(2,"0")}:${String(d).padStart(2,"0")}:00`,[h,x]=P.start.split("T"),[g,v]=x.split(":").map(Number);let f;if(f=h<t?0:60*g+v,s!==f)try{const e={start_time:u,end_time:m,date:l};await p(P.id,e)}catch(k){}return R(!1),z(null),B(null),void Y(null)}if(!v)return;ae.current&&(cancelAnimationFrame(ae.current),ae.current=null);const t=Math.min(b,S),a=Math.max(b,S);if(a-t<10)return f(!1),void(se.current=null);const s=Math.floor(t/60),n=t%60,l=Math.floor(a/60),i=a%60,r=`${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}:00`,u=`${String(l).padStart(2,"0")}:${String(i).padStart(2,"0")}:00`,m="plan"===j,h=o.find(e=>e.id)||o[0],x=h?h.id:null;try{const e=await d("ìƒˆ ì´ë²¤íŠ¸",r,u,x,m,"");if(e&&te.current){const a=te.current.getBoundingClientRect(),s=t/60*g,n=a.width/3;w(e),I({x:"plan"===j?n+10:a.width-10,y:s+220}),E(!0)}}catch(k){}f(!1),N(null),C(null),y(null),se.current=null},[v,M,O,P,K,L,V,Q,b,S,j,o,d,p]),ge=(t,n=!1)=>{const l=e(c),[o,i]=t.start.split("T"),[r,d]=t.end.split("T");let u,m;if(o<l)u=0;else{if(o>l)return null;{const[e,t]=i.split(":").map(Number);u=60*e+t}}if(r>l)m=1440;else{if(r<l)return null;{const[e,t]=d.split(":").map(Number);m=60*e+t}}const p=m-u;if(p<=0)return null;const h=M&&P&&P.id===t.id,x=O&&K&&K.id===t.id;let v,f;x?(v=V,f=Q):h?(v=L,f=L+p):(v=u,f=m);const j=v/60*g,y=(f-v)/60*g,b=(t.category||{color:"#9E9E9E"}).color,N=s(b,h?.6:n?.25:.35);let S,C;if(h||x){const e=Math.floor(v/60),t=v%60,a=Math.floor(f/60),s=f%60;S=`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}`,C=`${String(a).padStart(2,"0")}:${String(s).padStart(2,"0")}`}else S=i.substring(0,5),C=d.substring(0,5);const k=Math.floor(p/60),T=p%60,_=k>0?`${k}ì‹œê°„ ${T}ë¶„`:`${T}ë¶„`,$=p<=50;return a.jsxs("div",{className:"event-block-absolute",style:{background:N,color:"#000",top:`${j}px`,height:`${Math.max(y,20)}px`,cursor:n?"default":h?"grabbing":"grab",opacity:n?.9:h?.8:1,zIndex:h?1e3:1,transition:h?"none":"top 0.1s ease-out",border:n?`2px dashed ${b}`:void 0,padding:$?"1px 4px":"6px 8px",display:"flex",flexDirection:"column",justifyContent:$?"center":"flex-start"},onMouseDown:e=>!n&&ue(e,t),onTouchStart:e=>!n&&ue(e,t),onClick:e=>{M||O||n||((e,t)=>{if(te.current)if(w(e),ce())D(!0);else{const e=te.current.getBoundingClientRect(),a=t.clientX-e.left,s=t.clientY-e.top;I({x:a+10>e.width/2?a+150:a+10,y:s+220>e.height?s-30:s+10}),E(!0)}})(t,e)},title:n?`ðŸ“‹ ${t.title}\n${S} - ${C}\n(í• ì¼ ê³„íš)`:`${t.title}\n${S} - ${C}\n${_}`,children:[!n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"resize-handle resize-handle-top",style:{position:"absolute",top:0,left:0,right:0,height:"6px",cursor:"ns-resize",zIndex:10},onMouseDown:e=>me(e,t,"top"),onTouchStart:e=>me(e,t,"top"),onClick:e=>e.stopPropagation()}),a.jsx("div",{className:"resize-handle resize-handle-bottom",style:{position:"absolute",bottom:0,left:0,right:0,height:"6px",cursor:"ns-resize",zIndex:10},onMouseDown:e=>me(e,t,"bottom"),onTouchStart:e=>me(e,t,"bottom"),onClick:e=>e.stopPropagation()})]}),a.jsxs("div",{className:"event-title",style:{fontSize:$?"10px":"11px",lineHeight:$?"1.1":"1.4",whiteSpace:$?"nowrap":"normal",overflow:"hidden",textOverflow:"ellipsis"},children:[n?"ðŸ“‹ ":"",t.title,$&&a.jsxs("span",{style:{marginLeft:"4px",fontSize:"9px",opacity:.8,fontWeight:"normal"},children:[S,"-",C]})]}),!$&&a.jsxs("div",{className:"event-time",children:[S," - ",C]})]},t.id)},ve=()=>{if(!v)return null;const e=Math.min(b,S),t=Math.max(b,S),s=e/60*g,n=(t-e)/60*g,l=Math.floor(e/60),o=e%60,i=Math.floor(t/60),r=t%60,c=`${String(l).padStart(2,"0")}:${String(o).padStart(2,"0")}`,d=`${String(i).padStart(2,"0")}:${String(r).padStart(2,"0")}`,u=t-e<=50;return a.jsxs("div",{className:"event-block-absolute",style:{background:"rgba(66, 133, 244, 0.3)",border:"2px dashed #4285F4",top:`${s}px`,height:`${Math.max(n,20)}px`,pointerEvents:"none",padding:u?"1px 4px":"6px 8px",display:"flex",flexDirection:"column",justifyContent:u?"center":"flex-start"},children:[a.jsxs("div",{className:"event-title",style:{fontSize:u?"10px":"11px",lineHeight:u?"1.1":"1.4",whiteSpace:u?"nowrap":"normal",overflow:"hidden",textOverflow:"ellipsis"},children:["ìƒˆ ì´ë²¤íŠ¸",u&&a.jsxs("span",{style:{marginLeft:"4px",fontSize:"9px",opacity:.8,fontWeight:"normal"},children:[c,"-",d]})]}),!u&&a.jsxs("div",{className:"event-time",children:[c," - ",d]})]})},fe=l.useMemo(()=>n&&0!==n.length?n.filter(e=>e.scheduled_time).map(t=>{let a=null;if(t.category_id&&(a=o.find(e=>e.id==t.category_id)),!a&&t.todo_category_id&&i){const e=i.find(e=>e.id==t.todo_category_id);e&&e.event_category_id&&(a=o.find(t=>t.id==e.event_category_id))}a||(a={color:"#9E9E9E",name:"ê¸°íƒ€"});const s=e(c);let n=t.scheduled_time;5===n.length&&(n+=":00");const l=parseInt(t.duration)||30,[r,d]=n.split(":").map(Number),u=60*r+d+l,m=Math.floor(u/60)%24,p=u%60,h=`${String(m).padStart(2,"0")}:${String(p).padStart(2,"0")}:00`;return{id:`todo-${t.id}`,title:`ðŸ“ ${t.text}`,start:`${s}T${n}`,end:`${s}T${h}`,category:a,category_id:a.id,is_plan:!0,is_todo:!0}}):[],[n,o,i,c]),{planEvents:je,actualEvents:ye}=l.useMemo(()=>({planEvents:[...t.filter(e=>!0===e.is_plan),...fe],actualEvents:t.filter(e=>!1===e.is_plan)}),[t,fe]);return r?a.jsx("div",{className:"timeline-wrapper",children:a.jsxs("div",{className:"timeline-loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"ì´ë²¤íŠ¸ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]})}):a.jsxs(a.Fragment,{children:[(()=>{const{wakeTime:e,sleepTime:t}=x;return a.jsxs("div",{className:"wake-sleep-container",children:[a.jsxs("div",{className:"wake-sleep-item",children:["ðŸŒ… ê¸°ìƒ: ",a.jsx("span",{className:"time-value",children:e})]}),a.jsxs("div",{className:"wake-sleep-item",children:["ðŸŒ™ ì·¨ì¹¨: ",a.jsx("span",{className:"time-value",children:t})]}),a.jsx("button",{className:"add-event-button-mobile",onClick:de,title:"ì´ë²¤íŠ¸ ì¶”ê°€",children:"âž• ì´ë²¤íŠ¸ ì¶”ê°€"})]})})(),!1,a.jsxs("div",{className:"timeline-grid",children:[a.jsxs("div",{className:"timeline-header",children:[a.jsx("div",{children:"ê³„íš"}),a.jsx("div",{children:"ì‹œê°„"}),a.jsx("div",{children:"ì‹¤ì œ"})]}),a.jsxs("div",{ref:te,className:"timeline-wrapper",style:{minHeight:"960px",position:"relative"},onMouseMove:he,onMouseUp:xe,onTouchMove:he,onTouchEnd:xe,onMouseLeave:()=>{ae.current&&(cancelAnimationFrame(ae.current),ae.current=null),ne.current&&(cancelAnimationFrame(ne.current),ne.current=null),le.current&&(cancelAnimationFrame(le.current),le.current=null),f(!1),R(!1),z(null),B(null),Y(null),U(!1),H(null),X(null),G(null),Z(null),ee(null),se.current=null},children:[a.jsxs("div",{className:"timeline-columns",children:[a.jsxs("div",{className:"timeline-column plan-column",onMouseDown:e=>pe(e,"plan"),onTouchStart:e=>pe(e,"plan"),style:{position:"relative"},children:[a.jsx("div",{className:"timeline-hover-line",id:"timeline-hover-line-plan"}),je.map(e=>ge(e,e.is_todo)),v&&"plan"===j&&ve()]}),a.jsx("div",{className:"timeline-column time-column"}),a.jsxs("div",{className:"timeline-column actual-column",onMouseDown:e=>pe(e,"actual"),onTouchStart:e=>pe(e,"actual"),style:{position:"relative"},children:[a.jsx("div",{className:"timeline-hover-line",id:"timeline-hover-line-actual"}),ye.map(e=>ge(e,!1)),v&&"actual"===j&&ve()]})]}),a.jsx("div",{className:"time-markers",children:Array.from({length:24},(s,n)=>{const{wakeTime:l,wakeDateTime:o}=x,i=e(c);let r=!1;if(o&&"-"!==o&&null!==o){const e=o.split("T")[0],t=parseInt(o.split("T")[1].split(":")[0]);r=e===i&&t===n}let d=!1;const u=t.filter(e=>"ìž "===e.title&&e.category&&e.category.name&&e.category.name.includes("ìž ")&&!1===e.is_plan);for(const e of u){let t;if(e.start&&e.start.includes("T")?t=parseInt(e.start.split("T")[1].split(":")[0]):e.start_time&&(t=parseInt(e.start_time.split(":")[0])),t===n){d=!0;break}}const m={color:r?"#e03131":d?"#1971c2":void 0,fontWeight:r||d?"bold":void 0,fontSize:r||d?16:void 0,backgroundColor:r?"#ffe0e0":d?"#e0f2ff":void 0,borderRadius:r||d?"4px":void 0,padding:r||d?"2px 4px":void 0};return a.jsxs("div",{className:"time-marker-row",style:{height:"40px"},children:[a.jsx("div",{}),a.jsx("div",{className:"time-marker-label",style:m,children:String(n).padStart(2,"0")}),a.jsx("div",{})]},n)})}),e(c)===e(oe)&&a.jsx("div",{className:"current-time-indicator",style:{position:"absolute",top:(60*oe.getHours()+oe.getMinutes())/60*g+"px",left:0,right:0,height:"2px",backgroundColor:"red",opacity:.2,zIndex:20,pointerEvents:"none"},children:a.jsx("div",{style:{position:"absolute",left:"-5px",top:"-4px",width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"red"}})})]})]}),_&&k&&a.jsx(m,{event:k,categories:o,position:$,onUpdate:async(e,t)=>{try{await p(e,t),E(!1),w(null)}catch(a){}},onDelete:async e=>{try{await h(e),E(!1),w(null)}catch(t){}},onClose:()=>{E(!1),w(null)}}),T&&k&&a.jsx(u,{event:k,categories:o,onUpdate:async(e,t)=>{try{if(null===e){const{title:e,start_time:a,end_time:s,category_id:n,description:l,is_plan:o}=t;await d(e,a,s,n,o,l)}else await p(e,t);D(!1),w(null)}catch(a){}},onDelete:async e=>{try{await h(e),D(!1),w(null)}catch(t){}},onClose:()=>{D(!1),w(null)}})]})}const h=1500;function x({todoText:e,pomodoroCount:t,onComplete:s,onClose:n}){const[o,i]=l.useState(h),[r,c]=l.useState(!1),[d,u]=l.useState(!1),[m,p]=l.useState(!1),[x,g]=l.useState(!1),v=l.useRef(null),f=l.useRef(null);l.useEffect(()=>(r&&!d?v.current=setInterval(()=>{i(e=>e<=1?(clearInterval(v.current),c(!1),s(),h):e-1)},1e3):v.current&&clearInterval(v.current),()=>{v.current&&clearInterval(v.current)}),[r,d,s]),l.useEffect(()=>{if(f.current){const e=document.createElement("canvas");e.width=400,e.height=200;const t=e.getContext("2d"),a=()=>{t.clearRect(0,0,e.width,e.height),t.fillStyle="#ffffff",t.fillRect(0,0,e.width,e.height),t.fillStyle="#333333",t.font="bold 64px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(j(o),e.width/2,e.height/2),x&&requestAnimationFrame(a)};if(x){const t=e.captureStream(30);f.current.srcObject=t,a()}}},[o,x]);const j=e=>{const t=Math.floor(e/60),a=e%60;return`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`},y=()=>{c(!1),u(!1),i(h)},b=(h-o)/h*100;return a.jsx("div",{className:"pomodoro-overlay",children:a.jsxs("div",{className:"pomodoro-modal "+(m?"fullscreen":""),children:[a.jsx("button",{className:"pomodoro-close",onClick:n,children:"Ã—"}),a.jsxs("div",{className:"pomodoro-header",children:[a.jsx("div",{className:"pomodoro-todo-title",children:e}),a.jsxs("div",{className:"pomodoro-count-display",children:["ì™„ë£Œí•œ ë½€ëª¨ë„ë¡œ: ",t,"ê°œ ðŸ…"]})]}),a.jsxs("div",{className:"pomodoro-circle-container",children:[a.jsxs("svg",{className:"pomodoro-circle",viewBox:"0 0 200 200",children:[a.jsx("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"#e0e0e0",strokeWidth:"10"}),a.jsx("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"#ff6b6b",strokeWidth:"10",strokeDasharray:""+2*Math.PI*90,strokeDashoffset:""+2*Math.PI*90*(1-b/100),transform:"rotate(-90 100 100)",style:{transition:"stroke-dashoffset 1s linear"}})]}),a.jsx("div",{className:"pomodoro-time",children:j(o)})]}),a.jsx("div",{className:"pomodoro-controls",children:r?d?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"pomodoro-btn pomodoro-btn-primary",onClick:()=>{u(!1)},children:"ìž¬ê°œ"}),a.jsx("button",{className:"pomodoro-btn pomodoro-btn-secondary",onClick:y,children:"ì´ˆê¸°í™”"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"pomodoro-btn pomodoro-btn-secondary",onClick:()=>{u(!0)},children:"ì¼ì‹œì •ì§€"}),a.jsx("button",{className:"pomodoro-btn pomodoro-btn-secondary",onClick:y,children:"ì´ˆê¸°í™”"})]}):a.jsx("button",{className:"pomodoro-btn pomodoro-btn-primary",onClick:()=>{c(!0),u(!1)},children:"ì‹œìž‘"})}),a.jsxs("div",{className:"pomodoro-actions",children:[a.jsx("button",{className:"pomodoro-action-btn",onClick:()=>{p(!m)},children:m?"ì¢…ë£Œ":"ì „ì²´í™”ë©´"}),a.jsx("button",{className:"pomodoro-action-btn",onClick:async()=>{if(!x&&f.current)try{f.current.readyState<2&&await new Promise(e=>{f.current.onloadedmetadata=e}),await f.current.requestPictureInPicture(),g(!0)}catch(e){}else document.pictureInPictureElement&&(await document.exitPictureInPicture(),g(!1))},children:x?"PIP ì¢…ë£Œ":"PIP"})]}),a.jsx("video",{ref:f,style:{display:"none"},autoPlay:!0,muted:!0,playsInline:!0})]})})}function g({todos:e,categories:s,todoCategories:n,currentDate:o,onAdd:i,onUpdate:r,onDelete:c,onReorder:d,onOpenTodoCategoryManager:u}){var m,p;const[h,g]=l.useState(""),[v,f]=l.useState(!1),[j,y]=l.useState(null),[b,N]=l.useState(null),[S,C]=l.useState(""),[k,w]=l.useState(""),[T,D]=l.useState(null),[_,E]=l.useState(""),[$,I]=l.useState(null),[M,R]=l.useState(null),[P,z]=l.useState(""),[A,F]=l.useState(""),[L,B]=l.useState(null),[q,Y]=l.useState(null),O=e=>{if(!o||e.completed)return!1;const t=new Date;t.setHours(0,0,0,0);const a=new Date(o);return a.setHours(0,0,0,0),a<t},U=()=>{h.trim()&&(i(h.trim(),null,b,S||null,k?parseInt(k):null),g(""),y(null),N(null),C(""),w(""),f(!1))},W=e=>{_.trim()&&r(e,{text:_.trim(),category_id:$,todo_category_id:M,scheduled_time:P||null,duration:A?parseInt(A):null}),D(null),E(""),I(null),R(null),z(""),F("")},H=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},K=()=>{B(null)},X=[...e].sort((e,t)=>e.order-t.order),V=e=>s.find(t=>t.id===e),G=e=>null==n?void 0:n.find(t=>t.id===e),Q=async(e,a)=>{if(a)try{const s=await t.completeTodo(e);s.success&&s.event?window.location.reload():r(e,{completed:a})}catch(s){r(e,{completed:a})}else r(e,{completed:a})};return a.jsxs("div",{className:"todo-container",children:[a.jsxs("div",{className:"section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"âœ… ì˜¤ëŠ˜ í•  ì¼"}),a.jsx("button",{className:"btn-category-settings-small",onClick:u,title:"íˆ¬ë‘ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬",children:"âš™ï¸"})]}),a.jsxs("div",{className:"todo-input-group",style:{position:"relative"},children:[a.jsx("input",{type:"text",className:"todo-input",placeholder:"í•  ì¼ì„ ìž…ë ¥í•˜ì„¸ìš”...",value:h,onChange:e=>g(e.target.value),onKeyPress:e=>{"Enter"===e.key&&U()}}),a.jsx("button",{className:"btn-settings-popup",onClick:()=>f(!v),style:{background:v?"#f0f0f0":"white",border:"1px solid #e9e9e7",borderRadius:"4px",cursor:"pointer",fontSize:"16px",color:"#666",padding:"0 10px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"ìƒì„¸ ì„¤ì •",children:"âž•"}),a.jsx("button",{className:"btn",onClick:U,children:"ì¶”ê°€"}),v&&a.jsxs("div",{className:"todo-settings-popup",style:{position:"absolute",top:"100%",right:"0",marginTop:"8px",background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"16px",zIndex:100,width:"280px"},children:[a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:"íˆ¬ë‘ ì¹´í…Œê³ ë¦¬"}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:n&&n.length>0?n.map(e=>a.jsx("button",{className:"category-chip-small "+(b===e.id?"selected":""),style:{backgroundColor:b===e.id?e.color||"#4a9eff":"#f0f0f0",color:"#37352f",border:"none",padding:"4px 8px",borderRadius:"4px",fontSize:"11px",cursor:"pointer"},onClick:()=>N(b===e.id?null:e.id),children:e.name},e.id)):a.jsx("div",{style:{fontSize:"11px",color:"#999"},children:"ì¹´í…Œê³ ë¦¬ ì—†ìŒ"})})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:"ì‹œìž‘ ì‹œê°„"}),a.jsx("input",{type:"time",value:S,onChange:e=>C(e.target.value),style:{width:"100%",padding:"6px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:"ì†Œìš” ì‹œê°„ (ë¶„)"}),a.jsx("input",{type:"number",value:k,onChange:e=>w(e.target.value),placeholder:"30",min:"1",style:{width:"100%",padding:"6px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px"}})]})]})]}),a.jsx("ul",{className:"todo-list",children:0===X.length?a.jsx("li",{style:{textAlign:"left",fontSize:"13px",color:"#9b9a97",padding:"8px 0",listStyle:"none"},children:"í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤"}):X.map(t=>{return a.jsxs("li",{className:"todo-item "+((null==L?void 0:L.id)===t.id?"dragging":""),draggable:T!==t.id,onDragStart:e=>((e,t)=>{B(t),e.dataTransfer.effectAllowed="move"})(e,t),onDragOver:H,onDrop:a=>((t,a)=>{if(t.preventDefault(),!L||L.id===a.id)return void B(null);const s=[...e].sort((e,t)=>e.order-t.order),n=s.findIndex(e=>e.id===L.id),l=s.findIndex(e=>e.id===a.id);if(-1===n||-1===l)return void B(null);const o=[...s],[i]=o.splice(n,1);o.splice(l,0,i);const r=o.map((e,t)=>({id:e.id,order:t}));d(r),B(null)})(a,t),onDragEnd:K,children:[a.jsx("span",{className:"todo-drag-handle",children:"â‹®"}),O(t)?a.jsx("div",{className:"todo-checkbox overdue-arrow",onClick:()=>Q(t.id,!t.completed),style:{width:"20px",height:"20px",cursor:"pointer",flexShrink:0,margin:0,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #999",borderRadius:"3px",fontSize:"14px",color:"#fe7f65ff",background:"#fff",userSelect:"none",fontWeight:"bold"},title:"ë¯¸ì™„ë£Œ (í´ë¦­í•˜ì—¬ ì™„ë£Œ)",children:"â†’"}):a.jsx("input",{type:"checkbox",className:"todo-checkbox",checked:t.completed,onChange:()=>Q(t.id,!t.completed)}),T===t.id?a.jsxs("div",{className:"todo-edit-card compact",children:[a.jsxs("div",{className:"todo-edit-top-row",children:[a.jsx("input",{type:"text",className:"todo-edit-input-compact",value:_,onChange:e=>E(e.target.value),onKeyDown:e=>{"Enter"===e.key&&W(t.id)},autoFocus:!0,placeholder:"í•  ì¼ ìž…ë ¥"}),a.jsx("button",{className:"btn-save-compact",onClick:()=>W(t.id),children:"ì €ìž¥"})]}),a.jsxs("div",{className:"todo-edit-bottom-row",children:[a.jsx("div",{className:"todo-category-scroll",children:n&&n.length>0?n.map(e=>a.jsx("button",{className:"category-chip-micro "+(M===e.id?"selected":""),style:M===e.id?{backgroundColor:e.color||"#4a9eff",color:"#37352f",borderColor:e.color||"#4a9eff"}:{},onClick:t=>{t.stopPropagation(),R(M===e.id?null:e.id)},title:e.name,children:e.name},e.id)):a.jsx("span",{className:"no-cat-msg",children:"ì¹´í…Œê³ ë¦¬ ì—†ìŒ"})}),a.jsxs("div",{className:"todo-time-compact-group",children:[a.jsx("input",{type:"time",className:"todo-edit-time-compact",value:P,onChange:e=>z(e.target.value),title:"ì‹œìž‘ ì‹œê°„"}),a.jsxs("div",{className:"duration-wrapper",children:[a.jsx("input",{type:"number",className:"todo-edit-duration-compact",value:A,onChange:e=>F(e.target.value),placeholder:"ë¶„",title:"ì†Œìš” ì‹œê°„(ë¶„)"}),a.jsx("span",{className:"unit-text",children:"m"})]})]})]})]}):a.jsxs("div",{className:"todo-content",children:[a.jsxs("span",{className:"todo-text "+(t.completed?"completed":""),onDoubleClick:()=>(e=>{D(e.id),E(e.text),I(e.category_id||null),R(e.todo_category_id||null),z(e.scheduled_time||""),F(e.duration||"")})(t),children:[t.text,t.scheduled_time&&a.jsxs("span",{style:{marginLeft:"8px",fontSize:"11px",color:"#666"},children:["â° ",t.scheduled_time.slice(0,5)]}),t.duration&&a.jsxs("span",{style:{marginLeft:"4px",fontSize:"11px",color:"#666"},children:["(",t.duration,"ë¶„)"]})]}),t.category_id&&V(t.category_id)&&a.jsx("span",{className:"todo-category-badge",style:{backgroundColor:V(t.category_id).color,color:"#37352f"},children:V(t.category_id).name}),t.todo_category_id&&G(t.todo_category_id)&&a.jsx("span",{className:"todo-category-badge",style:{backgroundColor:G(t.todo_category_id).color||"#4a9eff",color:"#37352f"},children:G(t.todo_category_id).name}),(s=t.pomodoro_count,s&&0!==s?a.jsx("div",{className:"pomodoro-tomatoes",style:{display:"flex",gap:"4px",marginLeft:"8px"},children:Array.from({length:s}).map((e,t)=>a.jsx("img",{src:"/assets/pomo-BNnBQd7t.svg",alt:"pomodoro",width:"20",height:"20",style:{display:"block"}},t))}):null),a.jsx("button",{className:"pomodoro-start-btn",onClick:()=>{return e=t.id,void Y(e);var e},title:"ë½€ëª¨ë„ë¡œ ì‹œìž‘",children:"ðŸ…"})]}),a.jsx("button",{className:"todo-delete",onClick:()=>c(t.id),children:"Ã—"})]},t.id);var s})}),q&&a.jsx(x,{todoId:q,todoText:(null==(m=X.find(e=>e.id===q))?void 0:m.text)||"",pomodoroCount:(null==(p=X.find(e=>e.id===q))?void 0:p.pomodoro_count)||0,onComplete:()=>(async e=>{try{(await t.incrementPomodoro(e)).success&&r(e,{})}catch(a){}})(q),onClose:()=>{Y(null)}})]})}function v({routines:e,routineChecks:t,onToggle:s,onAdd:n,onUpdate:o,onDelete:i,onReorder:r}){const[c,d]=l.useState(""),[u,m]=l.useState(!1),[p,h]=l.useState(null),[x,g]=l.useState(""),[v,f]=l.useState(null),j=()=>{c.trim()&&(n(c.trim()),d(""),m(!1))},y=()=>{x.trim()&&o(p,{text:x.trim()}),h(null),g("")},b=()=>{h(null),g("")},N=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},S=()=>{f(null)},C=[...e].sort((e,t)=>e.order-t.order);return a.jsxs("div",{className:"routine-container",children:[a.jsxs("div",{className:"section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"ðŸ” ì˜¤ëŠ˜ì˜ ë£¨í‹´"}),a.jsx("button",{className:"btn-category-settings-small",onClick:()=>m(!0),title:"ìƒˆ ë£¨í‹´ ì¶”ê°€",children:"+"})]}),a.jsx("div",{className:"routine-grid",children:0===C.length?a.jsx("div",{style:{fontSize:"13px",color:"#9b9a97"},children:"ë£¨í‹´ì´ ì—†ìŠµë‹ˆë‹¤"}):C.map(n=>{const l=t[n.id]||!1,o=p===n.id;return a.jsx("div",{className:`routine-card ${l?"completed":""} ${(null==v?void 0:v.id)===n.id?"dragging":""}`,onClick:()=>!o&&s(n.id,!l),draggable:!o,onDragStart:e=>((e,t)=>{f(t),e.dataTransfer.effectAllowed="move"})(e,n),onDragOver:N,onDrop:t=>((t,a)=>{if(t.preventDefault(),!v||v.id===a.id)return void f(null);const s=[...e].sort((e,t)=>e.order-t.order),n=s.findIndex(e=>e.id===v.id),l=s.findIndex(e=>e.id===a.id);if(-1===n||-1===l)return void f(null);const o=[...s],[i]=o.splice(n,1);o.splice(l,0,i);const c=o.map((e,t)=>({id:e.id,order:t}));r(c),f(null)})(t,n),onDragEnd:S,children:o?a.jsxs("div",{className:"routine-edit-mode",onClick:e=>e.stopPropagation(),children:[a.jsx("input",{type:"text",className:"routine-edit-input",value:x,onChange:e=>g(e.target.value),onKeyPress:e=>{"Enter"===e.key&&y(),"Escape"===e.key&&b()},autoFocus:!0}),a.jsxs("div",{className:"routine-edit-actions",children:[a.jsx("button",{className:"routine-edit-btn save",onClick:y,children:"âœ“"}),a.jsx("button",{className:"routine-edit-btn cancel",onClick:b,children:"âœ•"})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"routine-title",children:n.text}),a.jsxs("div",{className:"routine-actions",children:[a.jsx("button",{className:"routine-action-btn edit",onClick:e=>((e,t)=>{t.stopPropagation(),h(e.id),g(e.text)})(n,e),title:"ìˆ˜ì •",children:"âœŽ"}),a.jsx("button",{className:"routine-action-btn delete",onClick:e=>((e,t)=>{t.stopPropagation(),confirm("ì´ ë£¨í‹´ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&i(e)})(n.id,e),title:"ì‚­ì œ",children:"Ã—"})]}),a.jsx("div",{className:"routine-check",children:l?"âœ“":""})]})},n.id)})}),u&&a.jsx("div",{className:"routine-modal-overlay",onClick:()=>m(!1),children:a.jsxs("div",{className:"routine-modal-content",onClick:e=>e.stopPropagation(),children:[a.jsx("h3",{className:"routine-modal-title",children:"ìƒˆ ë£¨í‹´ ì¶”ê°€"}),a.jsx("div",{className:"form-group",children:a.jsx("input",{type:"text",className:"routine-modal-input",placeholder:"ë£¨í‹´ ì´ë¦„ ìž…ë ¥...",value:c,onChange:e=>d(e.target.value),onKeyPress:e=>{"Enter"===e.key&&j()},autoFocus:!0})}),a.jsxs("div",{className:"routine-modal-actions",children:[a.jsx("button",{className:"routine-btn-cancel",onClick:()=>m(!1),children:"ì·¨ì†Œ"}),a.jsx("button",{className:"routine-btn-save",onClick:j,children:"ì¶”ê°€"})]})]})})]})}function f({selectedMood:e,onSelect:t}){return a.jsxs("div",{className:"mood-container",children:[a.jsx("div",{className:"section-header",children:"ðŸ˜Š ì˜¤ëŠ˜ì˜ ê¸°ë¶„"}),a.jsx("div",{className:"mood-selector",children:[{value:"bad",emoji:"ðŸ˜¢",label:"Bad"},{value:"soso",emoji:"ðŸ˜",label:"So-So"},{value:"good",emoji:"ðŸ˜Š",label:"Good"}].map(s=>a.jsxs("button",{className:"mood-btn "+(e===s.value?"selected":""),"data-mood":s.value,onClick:()=>t(s.value),children:[a.jsx("span",{className:"mood-emoji",children:s.emoji}),a.jsx("span",{className:"mood-label",children:s.label})]},s.value))})]})}const j="âœ¦[ì‹¤ì œ] ì˜¤ëŠ˜ ì‹¤ì œë¡œ í•œ ê²ƒ: :\nâœ§[ì—ë„ˆì§€] 0~10 ì¤‘:\nâœ§[ì¹­ì°¬] ì¹­ì°¬í•˜ê¸° :\n-------------------\nâœ§Keep           :\nâœ¦Problem        :\nâœ§TRY      :\n";function y({value:e,onSave:t}){const[s,n]=l.useState(e||j);l.useEffect(()=>{n(e||j)},[e]);return a.jsxs("div",{className:"reflection-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{children:"ðŸ“ ì˜¤ëŠ˜ì˜ íšŒê³ "}),s!==j&&a.jsx("button",{className:"template-btn",onClick:()=>{n(j)},title:"ê¸°ë³¸ í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸°",children:"ðŸ“‹ í…œí”Œë¦¿"})]}),a.jsx("textarea",{className:"reflection-textarea",placeholder:"ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ëŒì•„ë³´ë©°...",value:s,onChange:e=>n(e.target.value)}),a.jsx("button",{className:"btn",style:{marginTop:"12px",width:"100%"},onClick:()=>{t(s),alert("íšŒê³ ê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤!")},children:"ì €ìž¥í•˜ê¸°"})]})}function b({currentDate:t,images:s,onImageUploaded:n,onImageDeleted:o}){const[i,r]=l.useState(!1),c=e(t);return a.jsxs("div",{className:"image-upload-section",children:[a.jsx("div",{className:"section-header",children:"ðŸ“· ì˜¤ëŠ˜ì˜ ì‚¬ì§„"}),a.jsxs("div",{className:"images-grid",children:[s&&s.length>0&&s.map(e=>a.jsxs("div",{className:"image-item",children:[a.jsx("img",{src:e.view_url,alt:e.file_name,className:"image-thumbnail"}),a.jsx("button",{className:"image-delete-btn",onClick:()=>(async e=>{if(confirm("ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{const t=await fetch(`/api/images/${e}`,{method:"DELETE"}),a=await t.json();a.success?o(e):alert("ì‚­ì œ ì‹¤íŒ¨: "+a.error)}catch(t){alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}})(e.id),title:"ì‚­ì œ",children:"Ã—"})]},e.id)),a.jsxs("label",{className:"image-upload-card",children:[a.jsx("div",{className:"upload-icon",children:"+"}),a.jsx("div",{className:"upload-text",children:i?"ì—…ë¡œë“œ ì¤‘...":"ì‚¬ì§„ ì¶”ê°€"}),a.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:async e=>{const t=Array.from(e.target.files);if(0!==t.length){for(const e of t){if(!e.type.startsWith("image/"))return void alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.");if(e.size>5242880)return void alert(`${e.name}: íŒŒì¼ í¬ê¸°ëŠ” 5MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)}r(!0);try{for(const e of t){const t=new FormData;t.append("image",e),t.append("date",c);const a=await fetch("/api/images/upload",{method:"POST",body:t}),s=await a.json();if(!s.success){alert(`${e.name} ì—…ë¡œë“œ ì‹¤íŒ¨: ${s.error}`);break}n(s.data)}e.target.value=""}catch(a){alert("ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{r(!1)}}},disabled:i,style:{display:"none"}})]})]})]})}function N({events:e,categories:t,onOpenSettings:s,currentDate:n}){const l=(()=>{const a={};t&&t.length>0&&t.forEach(e=>{a[e.id]={name:e.name,hours:0,color:e.color}});const s=e.filter(e=>!1===e.is_plan),l=e=>{if(!e)return new Date;const t=e.split(/[+Z]/)[0];return new Date(t)},o=new Date(n);o.setHours(0,0,0,0);const i=new Date(n);return i.setHours(23,59,59,999),s&&s.length>0&&s.forEach(e=>{const t=e.category_id;if(t&&a[t]){const s=l(e.start),n=l(e.end),r=s>o?s:o,c=n<i?n:i;if(c>r){const e=(c-r)/36e5;a[t].hours+=e}}}),a})(),o=t||[];return a.jsxs("div",{className:"category-stats-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{children:"ðŸ“Š ì¹´í…Œê³ ë¦¬ë³„ ì‹œê°„ (ì‹¤ì œ)"}),a.jsx("button",{className:"btn-category-settings-small",onClick:s,title:"ì¹´í…Œê³ ë¦¬ ê´€ë¦¬",children:"âš™ï¸"})]}),a.jsx("div",{className:"category-matrix-wrapper",children:a.jsxs("table",{className:"category-matrix",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{}),o.map(e=>a.jsx("th",{style:{borderBottom:`3px solid ${e.color}`,color:"#37352f"},children:e.name},e.id))]})}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"ì‹œê°„"}),o.map(e=>a.jsx("td",{style:{borderBottom:`3px solid ${e.color}`,color:"#37352f"},children:a.jsxs("span",{className:"category-time",children:[l[e.id]?l[e.id].hours.toFixed(1):"0.0","h"]})},e.id))]})})]})})]})}function S({categories:e,onCategoriesChange:s}){const[n,o]=l.useState(!1),[i,r]=l.useState(null),[c,d]=l.useState(""),[u,m]=l.useState("#16a765"),[p,h]=l.useState(""),[x,g]=l.useState(""),v=()=>{r(null),h(""),g("")};return a.jsxs("div",{className:"category-manager",children:[a.jsxs("div",{className:"category-manager-header",children:[a.jsx("h3",{children:"ì¹´í…Œê³ ë¦¬ ê´€ë¦¬"}),!n&&a.jsx("button",{className:"btn-add-category",onClick:()=>o(!0),children:"+ ì¶”ê°€"})]}),n&&a.jsxs("div",{className:"category-form",children:[a.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"ì¹´í…Œê³ ë¦¬ ì´ë¦„",className:"category-name-input"}),a.jsx("input",{type:"color",value:u,onChange:e=>m(e.target.value),className:"category-color-picker"}),a.jsxs("div",{className:"category-form-actions",children:[a.jsx("button",{className:"btn-save",onClick:async()=>{if(c.trim())try{const e=await t.createCategory(c.trim(),u);e.success?(s(),d(""),m("#16a765"),o(!1)):alert("ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì‹¤íŒ¨: "+e.error)}catch(e){alert("ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},children:"ì €ìž¥"}),a.jsx("button",{className:"btn-cancel",onClick:()=>{o(!1),d(""),m("#16a765")},children:"ì·¨ì†Œ"})]})]}),a.jsx("div",{className:"category-list",children:e&&e.length>0?e.map(e=>a.jsx("div",{className:"category-item",children:i===e.id?a.jsxs("div",{className:"category-form",children:[a.jsx("input",{type:"text",value:p,onChange:e=>h(e.target.value),className:"category-name-input"}),a.jsx("input",{type:"color",value:x,onChange:e=>g(e.target.value),className:"category-color-picker"}),a.jsxs("div",{className:"category-form-actions",children:[a.jsx("button",{className:"btn-save",onClick:()=>(async e=>{if(p.trim())try{const a=await t.updateCategory(e,{name:p.trim(),color:x});a.success?(s(),r(null),h(""),g("")):alert("ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ì‹¤íŒ¨: "+a.error)}catch(a){alert("ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}})(e.id),children:"ì €ìž¥"}),a.jsx("button",{className:"btn-cancel",onClick:v,children:"ì·¨ì†Œ"})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"category-info",children:[a.jsx("span",{className:"category-color-box",style:{backgroundColor:e.color}}),a.jsx("span",{className:"category-name",children:e.name})]}),a.jsxs("div",{className:"category-actions",children:[a.jsx("button",{className:"btn-edit",onClick:()=>{return r((t=e).id),h(t.name),void g(t.color);var t},children:"ìˆ˜ì •"}),a.jsx("button",{className:"btn-delete",onClick:()=>(async e=>{if(window.confirm("ì´ ì¹´í…Œê³ ë¦¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì‚¬ìš© ì¤‘ì¸ ì¹´í…Œê³ ë¦¬ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤)"))try{const a=await t.deleteCategory(e);a.success?s():alert("ì¹´í…Œê³ ë¦¬ ì‚­ì œ ì‹¤íŒ¨: "+a.error)}catch(a){alert("ì¹´í…Œê³ ë¦¬ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}})(e.id),children:"ì‚­ì œ"})]})]})},e.id)):a.jsx("div",{className:"no-categories",children:"ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤. ì¶”ê°€í•´ì£¼ì„¸ìš”."})})]})}function C({todoCategories:e,eventCategories:t,onAdd:s,onUpdate:n,onDelete:o}){const[i,r]=l.useState(!1),[c,d]=l.useState(""),[u,m]=l.useState(null),[p,h]=l.useState("#4a9eff"),[x,g]=l.useState(null),[v,f]=l.useState(""),[j,y]=l.useState(null),[b,N]=l.useState("#4a9eff"),S=()=>{v.trim()&&(n(x,v.trim(),j,b),g(null),f(""),y(null),N("#4a9eff"))},C=()=>{g(null),f(""),y(null)},k=e=>null==t?void 0:t.find(t=>t.id===e);return a.jsxs("div",{className:"category-manager",children:[a.jsxs("div",{className:"category-manager-header",children:[a.jsx("h3",{children:"íˆ¬ë‘ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬"}),a.jsx("button",{className:"btn-add",onClick:()=>r(!0),children:"+ ì¶”ê°€"})]}),i&&a.jsxs("div",{className:"category-edit-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì¹´í…Œê³ ë¦¬ ì´ë¦„"}),a.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"ì˜ˆ: ê°œì¸, ì—…ë¬´, í•™ìŠµ...",autoFocus:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ìƒ‰ìƒ"}),a.jsxs("div",{className:"color-picker-wrapper",style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("input",{type:"color",value:p,onChange:e=>h(e.target.value),style:{width:"40px",height:"40px",padding:"0",border:"none",cursor:"pointer"}}),a.jsx("span",{className:"color-value",style:{fontSize:"13px",color:"#666"},children:p})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì—°ê²°í•  ì´ë²¤íŠ¸ ì¹´í…Œê³ ë¦¬ (ì„ íƒ)"}),a.jsxs("select",{value:u||"",onChange:e=>m(e.target.value?parseInt(e.target.value):null),children:[a.jsx("option",{value:"",children:"-- ì„ íƒ ì•ˆ í•¨ --"}),null==t?void 0:t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"btn-save",onClick:()=>{c.trim()&&(s(c.trim(),u,p),d(""),m(null),h("#4a9eff"),r(!1))},children:"ì €ìž¥"}),a.jsx("button",{className:"btn-cancel",onClick:()=>{r(!1),d(""),m(null)},children:"ì·¨ì†Œ"})]})]}),a.jsx("div",{className:"todo-category-list",children:0===(null==e?void 0:e.length)?a.jsx("div",{className:"empty-state",children:"íˆ¬ë‘ ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤"}):null==e?void 0:e.map(e=>x===e.id?a.jsxs("div",{className:"category-edit-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì¹´í…Œê³ ë¦¬ ì´ë¦„"}),a.jsx("input",{type:"text",value:v,onChange:e=>f(e.target.value),autoFocus:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ìƒ‰ìƒ"}),a.jsxs("div",{className:"color-picker-wrapper",style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("input",{type:"color",value:b,onChange:e=>N(e.target.value),style:{width:"40px",height:"40px",padding:"0",border:"none",cursor:"pointer"}}),a.jsx("span",{className:"color-value",style:{fontSize:"13px",color:"#666"},children:b})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì—°ê²°í•  ì´ë²¤íŠ¸ ì¹´í…Œê³ ë¦¬"}),a.jsxs("select",{value:j||"",onChange:e=>y(e.target.value?parseInt(e.target.value):null),children:[a.jsx("option",{value:"",children:"-- ì„ íƒ ì•ˆ í•¨ --"}),null==t?void 0:t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"btn-save",onClick:S,children:"ì €ìž¥"}),a.jsx("button",{className:"btn-cancel",onClick:C,children:"ì·¨ì†Œ"})]})]},e.id):a.jsxs("div",{className:"todo-category-item",children:[a.jsxs("div",{className:"todo-category-info",children:[a.jsxs("span",{className:"todo-category-name",style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("span",{className:"category-color-dot",style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:e.color||"#4a9eff",display:"inline-block"}}),e.name]}),e.event_category_id&&k(e.event_category_id)&&a.jsxs("span",{className:"linked-event-category",children:["â†’ ",k(e.event_category_id).name,a.jsx("span",{className:"category-color-dot",style:{backgroundColor:k(e.event_category_id).color}})]})]}),a.jsxs("div",{className:"category-actions",children:[a.jsx("button",{className:"btn-edit",onClick:()=>(e=>{g(e.id),f(e.name),y(e.event_category_id||null),N(e.color||"#4a9eff")})(e),children:"ìˆ˜ì •"}),a.jsx("button",{className:"btn-delete",onClick:()=>o(e.id),children:"ì‚­ì œ"})]})]},e.id))})]})}function k({currentDate:s,setCurrentDate:n}){const[o,i]=l.useState(!1),[r,c]=l.useState(!1),[u,m]=l.useState([]),{dailyData:h,addTodo:x,updateTodo:j,deleteTodo:k,reorderTodos:w,updateRoutineCheck:T,addRoutine:D,updateRoutine:_,deleteRoutine:E,reorderRoutines:$,saveData:I,addImageToState:M,removeImageFromState:R}=function(a){const[s,n]=l.useState({todos:[],reflection:"",mood:null,images:[],routines:[],routineChecks:{}}),[o,i]=l.useState(!0),r=e(a),c=l.useCallback(async()=>{i(!0);try{const e=await t.getDailyData(r);e.success&&n(e.data)}catch(e){}finally{i(!1)}},[r]);return l.useEffect(()=>{c()},[c]),{dailyData:s,loading:o,saveData:l.useCallback(async e=>{n(t=>({...t,...e}));try{await t.saveDailyData(r,e)}catch(a){await c()}},[r,c]),addImageToState:l.useCallback(e=>{n(t=>({...t,images:[...t.images||[],e]}))},[]),removeImageFromState:l.useCallback(e=>{n(t=>({...t,images:(t.images||[]).filter(t=>t.id!==e)}))},[]),addTodo:l.useCallback(async(e,a,s,n,l)=>{(await t.addTodo(r,e,a,s,n,l)).success&&await c()},[r,c]),updateTodo:l.useCallback(async(e,a)=>{(await t.updateTodo(e,a)).success&&await c()},[c]),deleteTodo:l.useCallback(async e=>{(await t.deleteTodo(e)).success&&await c()},[c]),reorderTodos:l.useCallback(async e=>{(await t.reorderTodos(e)).success&&await c()},[c]),updateRoutineCheck:l.useCallback(async(e,a)=>{(await t.updateRoutineCheck(r,e,a)).success&&n(t=>({...t,routineChecks:{...t.routineChecks,[e]:a}}))},[r]),addRoutine:l.useCallback(async e=>{(await t.addRoutine(e)).success&&await c()},[c]),updateRoutine:l.useCallback(async(e,a)=>{(await t.updateRoutine(e,a)).success&&await c()},[c]),deleteRoutine:l.useCallback(async e=>{(await t.deleteRoutine(e)).success&&await c()},[c]),reorderRoutines:l.useCallback(async e=>{(await t.reorderRoutines(e)).success&&await c()},[c]),reload:c}}(s),{categories:P,events:z,loading:A,reloadCategories:F,createEvent:L,updateEvent:B,deleteEvent:q,wakeSleepInfo:Y}=function(a){const[s,n]=l.useState([]),[o,i]=l.useState([]),[r,c]=l.useState({wakeTime:"-",wakeDateTime:null,sleepTime:"-",sleepDateTime:null}),[u,m]=l.useState(!0),p=e(a),h=l.useCallback(async()=>{try{const e=await t.getCategories();e.success&&n(e.categories)}catch(e){}},[]);l.useEffect(()=>{h()},[h]);const x=l.useCallback(async()=>{const e=d.get(p);if(e&&Date.now()-e.timestamp<3e5)return i(e.events),e.wakeSleepInfo&&c({wakeTime:e.wakeSleepInfo.wakeTime||"-",wakeDateTime:e.wakeSleepInfo.wakeDateTime||null,sleepTime:e.wakeSleepInfo.sleepTime||"-",sleepDateTime:e.wakeSleepInfo.sleepDateTime||null}),void m(!1);m(!0);try{const[e,a]=await Promise.all([t.getEvents(p),t.getWakeSleepEvents(p)]);let s=[];if(e.success&&(s=e.events),a.success){const e={wakeTime:a.wakeTime||"-",wakeDateTime:a.wakeDateTime||null,sleepTime:a.sleepTime||"-",sleepDateTime:a.sleepDateTime||null};c(e)}d.set(p,{events:s,wakeSleepInfo:a.success?a:{},timestamp:Date.now()}),i(s)}catch(a){}finally{m(!1)}},[p]);l.useEffect(()=>{x()},[x]);const g=l.useCallback(async(e,a,s,n,l=!1,o="",r=null)=>{try{const c=await t.createEvent(p,e,a,s,n,l,o,r);if(c.success)return i(e=>[...e,c.event]),r&&r!==p?d.clear():d.delete(p),c.event}catch(c){throw c}},[p]),v=l.useCallback(async(e,a)=>{try{const s=await t.updateEvent(e,a);if(s.success){const t=o.find(t=>t.id===e);let n=!1;if(t&&a.date){const e=t.start?t.start.split("T")[0]:null,s=a.date;n=e&&e!==s}return n?(i(t=>t.filter(t=>t.id!==e)),d.clear()):(i(t=>t.map(t=>t.id===e?s.event:t)),d.delete(p)),s.event}}catch(s){throw s}},[p,o]),f=l.useCallback(async e=>{try{(await t.deleteEvent(e)).success&&(i(t=>t.filter(t=>t.id!==e)),d.delete(p))}catch(a){throw a}},[p]),j=l.useCallback(async()=>{d.delete(p),await x()},[p]);return{categories:s,events:o,loading:u,reload:j,reloadCategories:h,createEvent:g,updateEvent:v,deleteEvent:f,wakeSleepInfo:r}}(s),O=l.useCallback(async()=>{try{const e=await t.getTodoCategories();e.success&&m(e.data)}catch(e){}},[]);l.useEffect(()=>{O()},[O]);const U=e=>{const t=new Date(s);t.setDate(t.getDate()+e),n(t)};return a.jsxs("div",{className:"main-container",children:[a.jsxs("div",{className:"left-panel",children:[a.jsxs("div",{className:"time-tracker-date-header",children:[a.jsx("button",{className:"date-nav-btn",onClick:()=>U(-1),children:"â—€"}),a.jsx("div",{className:"current-date",children:(W=s,W.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}))}),a.jsx("button",{className:"date-nav-btn",onClick:()=>U(1),children:"â–¶"})]}),a.jsx(p,{events:z,todos:h.todos,categories:P,todoCategories:u,loading:A,currentDate:s,onCreateEvent:L,onUpdateEvent:B,onDeleteEvent:q,wakeSleepInfo:Y})]}),a.jsxs("div",{className:"right-panel",children:[a.jsx(N,{events:z,categories:P,currentDate:s,onOpenSettings:()=>i(!0)}),a.jsx(v,{routines:h.routines,routineChecks:h.routineChecks,onToggle:T,onAdd:D,onUpdate:_,onDelete:E,onReorder:$}),a.jsx(g,{todos:h.todos,categories:P,todoCategories:u,currentDate:s,onAdd:x,onUpdate:j,onDelete:k,onReorder:w,onOpenTodoCategoryManager:()=>c(!0)}),a.jsx(f,{selectedMood:h.mood,onSelect:e=>I({mood:e})}),a.jsx(b,{currentDate:s,images:h.images||[],onImageUploaded:e=>{M(e)},onImageDeleted:e=>{R(e)}}),a.jsx(y,{value:h.reflection,onSave:e=>I({reflection:e})})]}),o&&a.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:a.jsxs("div",{className:"modal-content category-manager-modal",onClick:e=>e.stopPropagation(),children:[a.jsx(S,{categories:P,onCategoriesChange:F}),a.jsx("button",{className:"btn-close-modal",onClick:()=>i(!1),children:"ë‹«ê¸°"})]})}),r&&a.jsx("div",{className:"modal-overlay",onClick:()=>c(!1),children:a.jsxs("div",{className:"modal-content category-manager-modal",onClick:e=>e.stopPropagation(),children:[a.jsx(C,{todoCategories:u,eventCategories:P,onAdd:async(e,a,s)=>{try{(await t.addTodoCategory(e,a,s)).success&&O()}catch(n){}},onUpdate:async(e,a,s,n)=>{try{(await t.updateTodoCategory(e,a,s,n)).success&&O()}catch(l){}},onDelete:async e=>{try{(await t.deleteTodoCategory(e)).success&&O()}catch(a){}}}),a.jsx("button",{className:"btn-close-modal",onClick:()=>c(!1),children:"ë‹«ê¸°"})]})})]});var W}function w({onLoginSuccess:e,onSwitchToRegister:s}){const[n,o]=l.useState(""),[i,r]=l.useState(""),[c,d]=l.useState(""),[u,m]=l.useState(!1);return a.jsxs("div",{className:"auth-container",children:[a.jsxs("div",{className:"auth-brand-section",children:[a.jsxs("div",{className:"auth-brand-graphics",children:[a.jsx("div",{className:"graphic-bg-gradient"}),a.jsxs("div",{className:"graphic-clock-face",children:[a.jsx("div",{className:"clock-hand hour-hand"}),a.jsx("div",{className:"clock-hand minute-hand"}),a.jsx("div",{className:"clock-center"})]}),a.jsxs("div",{className:"graphic-cards-container",children:[a.jsxs("div",{className:"glass-card card-top",children:[a.jsx("div",{className:"card-line"}),a.jsx("div",{className:"card-line short"})]}),a.jsxs("div",{className:"glass-card card-middle",children:[a.jsx("div",{className:"card-icon"}),a.jsx("div",{className:"card-content"})]}),a.jsxs("div",{className:"glass-card card-bottom",children:[a.jsx("div",{className:"card-chart-bar"}),a.jsx("div",{className:"card-chart-bar"}),a.jsx("div",{className:"card-chart-bar"})]})]})]}),a.jsxs("div",{className:"auth-brand-content",children:[a.jsxs("h1",{className:"auth-brand-title",children:["TimeTracker",a.jsx("br",{}),"Diary"]}),a.jsx("p",{className:"auth-brand-subtitle",children:"í•˜ë£¨ë¥¼ ê¸°ë¡í•˜ê³ , ë” ë‚˜ì€ ë‚´ì¼ì„ ê³„íší•˜ì„¸ìš”."})]})]}),a.jsx("div",{className:"auth-form-section",children:a.jsxs("div",{className:"auth-box",children:[a.jsx("h1",{className:"auth-title",children:"ë¡œê·¸ì¸"}),a.jsx("p",{className:"auth-subtitle",children:"ì„œë¹„ìŠ¤ ì´ìš©ì„ ìœ„í•´ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”."}),a.jsxs("form",{onSubmit:async a=>{a.preventDefault(),d(""),m(!0);try{const a=await t.login(n,i);a.success?e(a.user):d(a.message||"ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(s){d("ì„œë²„ì™€ ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}finally{m(!1)}},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"ì´ë©”ì¼"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:e=>o(e.target.value),placeholder:"example@email.com",required:!0,autoComplete:"email"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"ë¹„ë°€ë²ˆí˜¸"}),a.jsx("input",{type:"password",id:"password",value:i,onChange:e=>r(e.target.value),placeholder:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",required:!0,autoComplete:"current-password",minLength:6})]}),c&&a.jsx("div",{className:"error-message",children:c}),a.jsx("button",{type:"submit",className:"auth-button",disabled:u,children:u?"ë¡œê·¸ì¸ ì¤‘...":"ë¡œê·¸ì¸"})]}),a.jsx("div",{className:"auth-footer",children:a.jsxs("p",{children:["ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?"," ",a.jsx("button",{type:"button",onClick:s,className:"link-button",children:"íšŒì›ê°€ìž…"})]})})]})})]})}function T({onRegisterSuccess:e,onSwitchToLogin:s}){const[n,o]=l.useState(""),[i,r]=l.useState(""),[c,d]=l.useState(""),[u,m]=l.useState(""),[p,h]=l.useState(""),[x,g]=l.useState(!1);return a.jsxs("div",{className:"auth-container",children:[a.jsxs("div",{className:"auth-brand-section",children:[a.jsxs("div",{className:"auth-brand-graphics",children:[a.jsx("div",{className:"graphic-bg-gradient"}),a.jsxs("div",{className:"graphic-clock-face",children:[a.jsx("div",{className:"clock-hand hour-hand"}),a.jsx("div",{className:"clock-hand minute-hand"}),a.jsx("div",{className:"clock-center"})]}),a.jsxs("div",{className:"graphic-cards-container",children:[a.jsxs("div",{className:"glass-card card-top",children:[a.jsx("div",{className:"card-line"}),a.jsx("div",{className:"card-line short"})]}),a.jsxs("div",{className:"glass-card card-middle",children:[a.jsx("div",{className:"card-icon"}),a.jsx("div",{className:"card-content"})]}),a.jsxs("div",{className:"glass-card card-bottom",children:[a.jsx("div",{className:"card-chart-bar"}),a.jsx("div",{className:"card-chart-bar"}),a.jsx("div",{className:"card-chart-bar"})]})]})]}),a.jsxs("div",{className:"auth-brand-content",children:[a.jsxs("h1",{className:"auth-brand-title",children:["TimeTracker",a.jsx("br",{}),"Diary"]}),a.jsx("p",{className:"auth-brand-subtitle",children:"í•˜ë£¨ë¥¼ ê¸°ë¡í•˜ê³ , ë” ë‚˜ì€ ë‚´ì¼ì„ ê³„íší•˜ì„¸ìš”."})]})]}),a.jsx("div",{className:"auth-form-section",children:a.jsxs("div",{className:"auth-box",children:[a.jsx("h1",{className:"auth-title",children:"íšŒì›ê°€ìž…"}),a.jsx("p",{className:"auth-subtitle",children:"ìƒˆë¡œìš´ ê³„ì •ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”."}),a.jsxs("form",{onSubmit:async a=>{if(a.preventDefault(),h(""),i===c)if(i.length<6)h("ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 6ìž ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");else{g(!0);try{const a=await t.register(n,i,u||null);a.success?e(a.user):h(a.message||"íšŒì›ê°€ìž…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(s){h("ì„œë²„ì™€ ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}finally{g(!1)}}else h("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"ì´ë©”ì¼ *"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:e=>o(e.target.value),placeholder:"example@email.com",required:!0,autoComplete:"email"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"username",children:"ì´ë¦„ (ì„ íƒ)"}),a.jsx("input",{type:"text",id:"username",value:u,onChange:e=>m(e.target.value),placeholder:"í™ê¸¸ë™",autoComplete:"name"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"ë¹„ë°€ë²ˆí˜¸ *"}),a.jsx("input",{type:"password",id:"password",value:i,onChange:e=>r(e.target.value),placeholder:"ìµœì†Œ 6ìž ì´ìƒ",required:!0,autoComplete:"new-password",minLength:6})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"confirmPassword",children:"ë¹„ë°€ë²ˆí˜¸ í™•ì¸ *"}),a.jsx("input",{type:"password",id:"confirmPassword",value:c,onChange:e=>d(e.target.value),placeholder:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ìž…ë ¥í•˜ì„¸ìš”",required:!0,autoComplete:"new-password",minLength:6})]}),p&&a.jsx("div",{className:"error-message",children:p}),a.jsx("button",{type:"submit",className:"auth-button",disabled:x,children:x?"ê°€ìž… ì¤‘...":"íšŒì›ê°€ìž…"})]}),a.jsx("div",{className:"auth-footer",children:a.jsxs("p",{children:["ì´ë¯¸ ê³„ì •ì´ ìžˆìœ¼ì‹ ê°€ìš”?"," ",a.jsx("button",{type:"button",onClick:s,className:"link-button",children:"ë¡œê·¸ì¸"})]})})]})})]})}const D=l.lazy(()=>function(e,t){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in c)return;c[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,s&&n.setAttribute("nonce",s),document.head.appendChild(n),t?new Promise((t,a)=>{n.addEventListener("load",t),n.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})}(()=>import("./monthly-DqeYW1a1.js").then(e=>e.M),__vite__mapDeps([0,1])));function _(){const[e,s]=l.useState(()=>localStorage.getItem("currentView")||"daily"),[n,o]=l.useState(()=>{const e=localStorage.getItem("currentDate");return e?new Date(e):new Date}),[i,r]=l.useState(null),[c,d]=l.useState("login"),[u,m]=l.useState(!0);l.useEffect(()=>{localStorage.setItem("currentView",e)},[e]),l.useEffect(()=>{localStorage.setItem("currentDate",n.toISOString())},[n]),l.useEffect(()=>{(async()=>{try{const e=await t.getCurrentUser();e.success&&r(e.user)}catch(e){}finally{m(!1)}})()},[]);const p=e=>{s(e)},h=e=>{r(e)},x=e=>{r(e)};return u?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",fontSize:"18px",color:"#666"},children:"ë¡œë”© ì¤‘..."}):i?a.jsxs("div",{className:"App",children:[a.jsxs("div",{className:"header",children:[a.jsx("div",{className:"header-title",children:"TimeTracker Diary"}),a.jsxs("div",{className:"header-actions",children:[a.jsxs("div",{className:"date-selector",children:[a.jsx("button",{className:"date-nav-btn view-toggle-btn "+("daily"===e?"active":""),onClick:()=>p("daily"),children:"Daily"}),a.jsx("button",{className:"date-nav-btn view-toggle-btn "+("monthly"===e?"active":""),onClick:()=>p("monthly"),children:"Monthly"})]}),a.jsxs("div",{className:"user-info",children:[a.jsx("span",{className:"user-email",children:i.email}),a.jsx("button",{className:"logout-btn",onClick:async()=>{try{await t.logout(),r(null)}catch(e){}},children:"ë¡œê·¸ì•„ì›ƒ"})]})]})]}),a.jsx("div",{className:"view-container "+("daily"===e?"active":""),children:"daily"===e&&a.jsx(k,{currentDate:n,setCurrentDate:o})}),a.jsx("div",{className:"view-container "+("monthly"===e?"active":""),children:"monthly"===e&&a.jsx(l.Suspense,{fallback:a.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"ë¡œë”© ì¤‘..."}),children:a.jsx(D,{goToDate:e=>{const[t,a,n]=e.split("-").map(Number);o(new Date(t,a-1,n)),s("daily")}})})})]}):"login"===c?a.jsx(w,{onLoginSuccess:h,onSwitchToRegister:()=>d("register")}):a.jsx(T,{onRegisterSuccess:x,onSwitchToLogin:()=>d("login")})}i.createRoot(document.getElementById("root")).render(a.jsx(o.StrictMode,{children:a.jsx(_,{})}));

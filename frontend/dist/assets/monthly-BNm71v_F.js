import{r as e}from"./react-vendor-DtX1tuCI.js";var t={exports:{}},a={},n=e,s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,a){var n,o={},l=null,d=null;for(n in void 0!==a&&(l=""+a),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)r.call(t,n)&&!c.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:s,type:e,key:l,ref:d,props:o,_owner:i.current}}a.Fragment=o,a.jsx=l,a.jsxs=l,t.exports=a;var d=t.exports;const h=new Map,m={getDailyData:async e=>(await fetch(`/api/daily/${e}`)).json(),saveDailyData:async(e,t)=>(await fetch(`/api/daily/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json(),addTodo:async(e,t,a,n,s,o)=>(await fetch("/api/todos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e,text:t,category:a,todo_category_id:n,scheduled_time:s,duration:o})})).json(),updateTodo:async(e,t)=>(await fetch(`/api/todos/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json(),deleteTodo:async e=>(await fetch(`/api/todos/${e}`,{method:"DELETE"})).json(),reorderTodos:async e=>(await fetch("/api/todos/reorder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({updates:e})})).json(),incrementPomodoro:async e=>(await fetch(`/api/todos/${e}/pomodoro`,{method:"POST",headers:{"Content-Type":"application/json"}})).json(),getRoutines:async()=>(await fetch("/api/routines")).json(),addRoutine:async(e,t)=>(await fetch("/api/routines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,order:t})})).json(),updateRoutine:async(e,t)=>(await fetch(`/api/routines/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json(),deleteRoutine:async e=>(await fetch(`/api/routines/${e}`,{method:"DELETE"})).json(),reorderRoutines:async e=>(await fetch("/api/routines/reorder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({updates:e})})).json(),updateRoutineCheck:async(e,t,a)=>(await fetch("/api/routine-checks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e,routine_id:t,checked:a})})).json(),getCategories:async()=>(await fetch("/api/categories")).json(),createCategory:async(e,t)=>(await fetch("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,color:t})})).json(),updateCategory:async(e,t)=>(await fetch(`/api/categories/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json(),deleteCategory:async e=>(await fetch(`/api/categories/${e}`,{method:"DELETE"})).json(),getEvents:async e=>(await fetch("/api/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e})})).json(),createEvent:async(e,t,a,n,s,o,r,i)=>(await fetch("/api/events/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e,title:t,start_time:a,end_time:n,category_id:s,is_plan:o,description:r,end_date:i})})).json(),updateEvent:async(e,t)=>(await fetch(`/api/events/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json(),deleteEvent:async e=>(await fetch(`/api/events/${e}`,{method:"DELETE"})).json(),getWakeSleepEvents:async e=>(await fetch("/api/events/wake-sleep",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e})})).json(),async getMonthlyStats(e,t){const a=`${e}-${String(t).padStart(2,"0")}`,n=h.get(a);if(n&&Date.now()-n.ts<6e4)return n.data;const s=await fetch("/api/monthly/stats",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({year:e,month:t})}),o=await s.json();return o&&o.success&&h.set(a,{data:o,ts:Date.now()}),o},getMonthlyTimeStats:async(e,t)=>(await fetch("/api/monthly/time-stats",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({year:e,month:t})})).json(),getMonthlyRoutineMoodStats:async(e,t)=>(await fetch("/api/monthly/routine-mood-stats",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({year:e,month:t})})).json(),saveFeedback:async(e,t)=>(await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e,feedback:t})})).json(),create10AMWake:async e=>(await fetch("/api/events/create-wake",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e,time:"10:00"})})).json(),getTodoCategories:async()=>(await fetch("/api/todo-categories")).json(),addTodoCategory:async(e,t,a)=>(await fetch("/api/todo-categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,event_category_id:t,color:a})})).json(),updateTodoCategory:async(e,t,a,n)=>(await fetch(`/api/todo-categories/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,event_category_id:a,color:n})})).json(),deleteTodoCategory:async e=>(await fetch(`/api/todo-categories/${e}`,{method:"DELETE"})).json(),completeTodo:async e=>(await fetch(`/api/todos/${e}/complete`,{method:"POST",headers:{"Content-Type":"application/json"}})).json()},p={"â‘ ":"#fbb9b6","â‘¡":"#fbf5b6","â‘¢":"#cafbb6","â‘£":"#fbdfb6","â‘¤":"#cab6fb","â‘¥":"#b6f4fb","â‘¦":"#e8ceb4"},u={"â‘  ë‚­ë¹„ì‹œê°„":"#D13F3F","â‘¡ ì‚¬íšŒì ":"#A78400","â‘¢ ì§€ì ":"#1E7B34","â‘£ ì˜ì ":"#C46C00","â‘¤ ìž ":"#4A4AC4","â‘¥ ìš´ë™":"#008C99","â‘¦ ê¸°íƒ€":"#654321",default:"#37352f"};function y(e,t){if(!e)return`rgba(0,0,0,${t||1})`;let a=e.replace("#","");3===a.length&&(a=a.split("").map(e=>e+e).join(""));return`rgba(${parseInt(a.substring(0,2),16)}, ${parseInt(a.substring(2,4),16)}, ${parseInt(a.substring(4,6),16)}, ${t})`}function g(e){const t=new Date(e.toLocaleString("en-US",{timeZone:"Asia/Seoul"}));return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function f({currentMonth:t,goToDate:a}){const[n,s]=e.useState([]),[o,r]=e.useState([]),[i,c]=e.useState(!0),[l,h]=e.useState(null),f=e.useRef(null);e.useEffect(()=>{j()},[t]);const j=async()=>{c(!0),h(null);try{const e=t.getFullYear(),a=t.getMonth()+1,n=await m.getMonthlyTimeStats(e,a);n.success?(s(n.data.days),r(n.data.categories||[]),requestAnimationFrame(()=>{x(n.data.days)})):h(n.error||"ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨")}catch(e){h(e.message||"ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")}finally{c(!1)}},x=e=>{if(!f.current)return;const t=f.current.querySelectorAll(".tt-day-column"),a=e.flatMap(e=>e.events||[]);e.forEach(e=>{const n=t[e.date-1];n&&(e.events&&e.events.length>0&&v(n,e.events),S(n,e.date,a))})},S=(e,a,n)=>{const s=t.getFullYear(),o=t.getMonth(),r=g(new Date(s,o,a));let i=null,c=null;const l=e=>{if(!e)return new Date;const t=e.split(/[+Z]/)[0];return new Date(t)};n.forEach(e=>{if("ìž "===e.title){const t=l(e.start),a=l(e.end),n=g(t);if(g(a)===r&&(i=a.getHours()),n===r){const e=t.getHours();(null===c||e>c)&&(c=e)}}});const d=e.querySelectorAll(".tt-hour-cell");if(null!==i&&d[i]){const e=document.createElement("div");e.className="tt-wake-marker",e.textContent=String(i).padStart(2,"0"),d[i].appendChild(e)}if(null!==c&&d[c]){const e=document.createElement("div");e.className="tt-sleep-marker",e.textContent=String(c).padStart(2,"0"),d[c].appendChild(e)}},v=(e,a)=>{var n;const s=e.querySelector(".tt-date-header"),o=e.querySelector(".tt-hour-cell");if(!s||!o)return;const r=s.offsetHeight,i=o.offsetHeight,c=parseInt((null==(n=e.querySelector(".tt-date-day"))?void 0:n.textContent)||"0");if(!c)return;const l=t.getFullYear(),d=t.getMonth(),h=new Date(l,d,c,0,0,0,0),m=new Date(l,d,c+1,0,0,0,0),g=e=>{if(!e)return new Date;const t=e.split(/[+Z]/)[0];return new Date(t)};a.filter(e=>!1===e.is_plan).forEach(t=>{const a=g(t.start),n=g(t.end),s=a<h?h:a,o=n>m?m:n;let c=60*s.getHours()+s.getMinutes(),l=60*o.getHours()+o.getMinutes();o.getTime()===m.getTime()&&(l=1440);const d=l-c;if(d<=0)return;const f=r+c/60*i,j=d/60*i,x=document.createElement("div");x.className="tt-event-block";const S=function(e,t){if(!e)return t||"#2383e2";const a=e.match(/[â‘ â‘¡â‘¢â‘£â‘¤â‘¥â‘¦â‘§â‘¨]/);return a&&p[a[0]]?p[a[0]]:t||"#2383e2"}(t.calendarName,t.color),v=function(e){if(!e)return"#ffffff";if(u[e])return u[e];const t=e.match(/[â‘ â‘¡â‘¢â‘£â‘¤â‘¥â‘¦â‘§â‘¨]/);if(t){const e={"â‘ ":"â‘  ë‚­ë¹„ì‹œê°„","â‘¡":"â‘¡ ì‚¬íšŒì ","â‘¢":"â‘¢ ì§€ì ","â‘£":"â‘£ ì˜ì ","â‘¤":"â‘¤ ìž ","â‘¥":"â‘¥ ìš´ë™","â‘¦":"â‘¦ ê¸°íƒ€"}[t[0]];if(e&&u[e])return u[e]}return u.default}(t.calendarName),N=y(S,.35);Object.assign(x.style,{background:N,color:v,borderLeftColor:S,top:f+"px",height:Math.max(j,8)+"px",position:"absolute",left:"2px",right:"2px"});const b=document.createElement("div");b.className="tt-event-tooltip";const w=a.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"}),T=n.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"});b.innerHTML=`\n        <div class="tt-tooltip-title">${t.title}</div>\n        <div class="tt-tooltip-time">${w} - ${T}</div>\n      `,x.appendChild(b),e.appendChild(x)})};return i?d.jsx("div",{className:"monthly-timetracker-wrapper",children:d.jsx("div",{className:"loading",children:"ë°ì´í„° ë¡œë”© ì¤‘..."})}):l?d.jsx("div",{className:"monthly-timetracker-wrapper",children:d.jsxs("div",{className:"loading",style:{color:"#eb5757"},children:["ì˜¤ë¥˜: ",l]})}):(()=>{const e=t.getFullYear(),n=t.getMonth()+1,s=new Date(e,n,0).getDate(),o=g(new Date),r=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];return d.jsx("div",{className:"monthly-timetracker-wrapper",children:d.jsxs("div",{className:"monthly-timetracker",ref:f,children:[d.jsxs("div",{className:"tt-time-column",children:[d.jsx("div",{className:"tt-time-header",children:"ì‹œê°„"}),Array.from({length:24},(e,t)=>d.jsx("div",{className:"tt-hour-cell tt-time-cell",children:String(t).padStart(2,"0")},t))]}),Array.from({length:s},(t,s)=>{const i=s+1,c=new Date(e,n-1,i),l=g(c),h=c.getDay(),m=l===o,p=0===h||6===h;return d.jsxs("div",{className:"tt-day-column "+(p?"weekend":""),style:{gridColumn:i+1,gridRow:"1 / -1"},children:[d.jsxs("div",{className:`tt-date-header ${m?"today":""} ${p?"weekend":""}`,onClick:()=>a(l),children:[d.jsx("div",{className:"tt-date-day",children:i}),d.jsx("div",{className:"tt-date-weekday",children:r[h]})]}),Array.from({length:24},(e,t)=>d.jsx("div",{className:"tt-hour-cell","data-hour":t},t))]},i)})]})})})()}function j({currentMonth:t,goToDate:a}){const[n,s]=e.useState(null),[o,r]=e.useState(!0),[i,c]=e.useState(null);e.useEffect(()=>{l()},[t]);const l=async()=>{r(!0),c(null);try{const e=t.getFullYear(),a=t.getMonth()+1,n=await m.getMonthlyRoutineMoodStats(e,a);n.success?s(n.data):c(n.error||"ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨")}catch(e){c(e.message||"ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")}finally{r(!1)}};return o?d.jsx("div",{className:"monthly-stats-wrapper",children:d.jsx("div",{className:"loading",children:"í†µê³„ ë¡œë”© ì¤‘..."})}):i?d.jsx("div",{className:"monthly-stats-wrapper",children:d.jsxs("div",{className:"loading",style:{color:"#eb5757"},children:["ì˜¤ë¥˜: ",i]})}):d.jsxs("div",{className:"monthly-stats-wrapper",children:[d.jsxs("div",{className:"stats-section stats-half",children:[d.jsx("h3",{className:"stats-section-title",children:"ðŸ“ˆ ë£¨í‹´ ìˆ˜í–‰ë¥ "}),(()=>{if(!n||!n.routineStats||0===n.routineStats.length)return d.jsx("div",{className:"no-data",children:"ë£¨í‹´ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"});const e=n.routineStats;return d.jsx("div",{className:"routine-bar-chart",children:e.map((e,t)=>{return d.jsxs("div",{className:"routine-bar-item",children:[d.jsx("div",{className:"routine-bar-label",children:e.text}),d.jsx("div",{className:"routine-bar-container",children:d.jsx("div",{className:"routine-bar-fill",style:{width:`${e.percentage}%`,backgroundColor:(a=e.percentage,a>=70?"#a8e6cf":a>=40?"#ffd3b6":"#ffaaa5")},children:d.jsxs("span",{className:"routine-bar-percentage",children:[e.percentage,"%"]})})})]},t);var a})})})()]}),d.jsx("div",{className:"stats-row",children:d.jsxs("div",{className:"stats-section stats-half",children:[d.jsx("h3",{className:"stats-section-title",children:"ðŸ˜Š ê¸°ë¶„ í†µê³„"}),(()=>{if(!n||!n.moodStats)return d.jsx("div",{className:"no-data",children:"ê¸°ë¶„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"});const{counts:e,percentages:t,total:a,labels:s}=n.moodStats,o={Good:"#a8e6cf",SoSo:"#ffd3b6",Bad:"#ffaaa5"};let r=-90;const i=[];Object.keys(e).forEach(a=>{if(e[a]>0){const n=t[a],c=n/100*360;i.push({mood:a,startAngle:r,endAngle:r+c,percentage:n,count:e[a],color:o[a],label:s[a]}),r+=c}});const c=e=>{const{startAngle:t,endAngle:a,color:n}=e,s=80,o=t*Math.PI/180,r=a*Math.PI/180;return["M 100 100",`L ${100+s*Math.cos(o)} ${100+s*Math.sin(o)}`,`A 80 80 0 ${a-t>180?1:0} 1 ${100+s*Math.cos(r)} ${100+s*Math.sin(r)}`,"Z"].join(" ")},l=e=>{const{startAngle:t,endAngle:a}=e,n=(t+a)/2*Math.PI/180;return{x:100+55*Math.cos(n),y:100+55*Math.sin(n)}};return d.jsxs("div",{className:"mood-pie-container",children:[d.jsx("div",{className:"pie-chart-wrapper",children:d.jsx("svg",{viewBox:"0 0 200 200",className:"pie-chart",children:i.map((e,t)=>d.jsxs("g",{children:[d.jsx("path",{d:c(e),fill:e.color,stroke:"white",strokeWidth:"2"}),e.percentage>0&&d.jsxs("text",{x:l(e).x,y:l(e).y,textAnchor:"middle",dominantBaseline:"middle",fill:"#333",fontSize:"10",fontWeight:"600",children:[d.jsx("tspan",{x:l(e).x,dy:"-5",children:e.label}),d.jsxs("tspan",{x:l(e).x,dy:"12",children:[e.percentage,"%"]})]})]},t))})}),d.jsxs("div",{className:"pie-legend",children:[i.map((e,t)=>d.jsxs("div",{className:"legend-item",children:[d.jsx("div",{className:"legend-color",style:{backgroundColor:e.color}}),d.jsxs("div",{className:"legend-label",children:[e.label,": ",e.count,"ì¼ (",e.percentage,"%)"]})]},t)),d.jsxs("div",{className:"mood-total",children:["ì´ ê¸°ë¡ì¼: ",a,"ì¼"]})]})]})})()]})}),d.jsxs("div",{className:"stats-section",children:[d.jsx("h3",{className:"stats-section-title",children:"ðŸ“Š ë£¨í‹´ ìˆ˜í–‰ í˜„í™©"}),(()=>{if(!n||!n.routineStats||0===n.routineStats.length)return d.jsx("div",{className:"no-data",children:"ë£¨í‹´ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"});const e=t.getFullYear(),s=t.getMonth()+1,o=new Date(e,s,0).getDate(),r=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];return d.jsx("div",{className:"stats-table-wrapper",children:d.jsxs("table",{className:"stats-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{className:"routine-name-col",children:"ë£¨í‹´"}),Array.from({length:o},(t,n)=>{const o=n+1,i=new Date(e,s-1,o).getDay(),c=0===i||6===i,l=g(new Date),h=`${e}-${String(s).padStart(2,"0")}-${String(o).padStart(2,"0")}`,m=h===l;return d.jsxs("th",{className:`day-col ${c?"weekend":""} ${m?"today":""}`,onClick:()=>a(h),children:[d.jsx("div",{className:"day-num",children:o}),d.jsx("div",{className:"day-weekday",children:r[i]})]},o)}),d.jsx("th",{className:"percentage-col",children:"ìˆ˜í–‰ë¥ "})]})}),d.jsx("tbody",{children:n.routineStats.map(t=>d.jsxs("tr",{children:[d.jsx("td",{className:"routine-name",children:t.text}),Array.from({length:o},(n,o)=>{const r=o+1,i=`${e}-${String(s).padStart(2,"0")}-${String(r).padStart(2,"0")}`,c=t.dailyStatus[i],l=new Date(e,s-1,r).getDay(),h=0===l||6===l,m=new Date;m.setHours(0,0,0,0);const p=new Date(e,s-1,r);p.setHours(0,0,0,0);const u=p>m;return d.jsx("td",{className:`status-cell ${h?"weekend":""} ${u?"future":""}`,onClick:()=>a(i),children:u?"":c?"â­•":"âŒ"},r)}),d.jsx("td",{className:"percentage-cell",children:d.jsxs("div",{className:"percentage-bar-wrapper",children:[d.jsx("div",{className:"percentage-bar",style:{width:`${t.percentage}%`}}),d.jsxs("span",{className:"percentage-text",children:[t.percentage,"%"]})]})})]},t.id))})]})})})()]}),d.jsxs("div",{className:"stats-section",children:[d.jsx("h3",{className:"stats-section-title",children:"ðŸ“… ê¸°ë¶„ ë‹¬ë ¥"}),(()=>{if(!n||!n.dailyMoods)return d.jsx("div",{className:"no-data",children:"ê¸°ë¶„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"});const e=t.getFullYear(),s=t.getMonth()+1,o=new Date(e,s,0).getDate(),r=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "],i={Good:"ðŸ˜Š",SoSo:"ðŸ˜",Bad:"ðŸ˜¢"},c={Good:"#a8e6cf",SoSo:"#ffd3b6",Bad:"#ffaaa5"};return d.jsx("div",{className:"mood-table-wrapper",children:d.jsxs("table",{className:"mood-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{className:"mood-label-col",children:"ë‚ ì§œ"}),Array.from({length:o},(t,n)=>{const o=n+1,i=new Date(e,s-1,o).getDay(),c=0===i||6===i,l=g(new Date),h=`${e}-${String(s).padStart(2,"0")}-${String(o).padStart(2,"0")}`,m=h===l;return d.jsxs("th",{className:`day-col ${c?"weekend":""} ${m?"today":""}`,onClick:()=>a(h),children:[d.jsx("div",{className:"day-num",children:o}),d.jsx("div",{className:"day-weekday",children:r[i]})]},o)})]})}),d.jsx("tbody",{children:["Good","SoSo","Bad"].map(t=>d.jsxs("tr",{children:[d.jsxs("td",{className:"mood-label",children:[i[t]," ",t]}),Array.from({length:o},(o,r)=>{const l=r+1,h=`${e}-${String(s).padStart(2,"0")}-${String(l).padStart(2,"0")}`,m=n.dailyMoods[h],p=new Date(e,s-1,l).getDay(),u=0===p||6===p,y=m?m.charAt(0).toUpperCase()+m.slice(1).toLowerCase():null,g=("Soso"===y?"SoSo":y)===t,f=g?{backgroundColor:c[t]}:{};return d.jsx("td",{className:`mood-cell ${u?"weekend":""} ${g?"checked":""}`,onClick:()=>a(h),title:`${h}: ${m||"ì—†ìŒ"}`,style:f,children:g?i[t]:""},l)})]},t))})]})})})()]})]})}const x=Object.freeze(Object.defineProperty({__proto__:null,default:function({goToDate:t}){const[a,n]=e.useState(new Date),[s,o]=e.useState([]),[r,i]=e.useState(!0),[c,l]=e.useState("calendar"),[h,p]=e.useState(new Set),u=e.useRef(null);e.useEffect(()=>{y()},[a]),e.useEffect(()=>{if("calendar"===c)return u.current=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target,a=t.dataset.src;a&&!t.src&&(t.src=a,u.current.unobserve(t))}})},{rootMargin:"50px",threshold:.01}),()=>{u.current&&u.current.disconnect()}},[c]);const y=async()=>{i(!0);try{const e=a.getFullYear(),t=a.getMonth()+1,n=await m.getMonthlyStats(e,t);n.success&&o(n.data)}catch(e){}finally{i(!1)}},x=e=>{const t=new Date(a);t.setMonth(t.getMonth()+e),n(t)},S=e.useCallback(e=>{e&&u.current&&u.current.observe(e)},[]);return d.jsxs("div",{className:"monthly-container",children:[d.jsxs("div",{className:"monthly-header",children:[d.jsx("button",{className:"month-nav-btn",onClick:()=>x(-1),children:"â—€"}),d.jsx("div",{className:"current-month",children:`${a.getFullYear()}ë…„ ${a.getMonth()+1}ì›”`}),d.jsx("button",{className:"month-nav-btn",onClick:()=>x(1),children:"â–¶"}),d.jsx("div",{className:"header-actions",children:d.jsxs("div",{className:"view-mode-selector header-inline",children:[d.jsx("button",{className:"view-mode-btn "+("calendar"===c?"active":""),onClick:()=>l("calendar"),children:"ðŸ“… ìº˜ë¦°ë” ë·°"}),d.jsx("button",{className:"view-mode-btn "+("time"===c?"active":""),onClick:()=>l("time"),children:"â° ì‹œê°„ ì¶”ì  ë·°"}),d.jsx("button",{className:"view-mode-btn "+("stats"===c?"active":""),onClick:()=>l("stats"),children:"ðŸ“Š í†µê³„ ë·°"})]})})]}),r&&"calendar"===c?d.jsx("div",{className:"loading",children:"ë¡œë”© ì¤‘..."}):d.jsxs(d.Fragment,{children:["calendar"===c&&(()=>{const e=a.getFullYear(),n=a.getMonth(),o=new Date(e,n,1).getDay(),r=g(new Date);return d.jsxs("div",{className:"monthly-grid",children:[["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "].map(e=>d.jsx("div",{className:"monthly-day-header",children:e},e)),Array.from({length:o},(e,t)=>d.jsx("div",{className:"monthly-day-cell empty"},`empty-${t}`)),(()=>{const a=(s||[]).reduce((e,t)=>(e[t.date]=t.firstImage,e),{});return Array.from({length:new Date(e,n+1,0).getDate()},(s,o)=>{const i=o+1,c=`${e}-${String(n+1).padStart(2,"0")}-${String(i).padStart(2,"0")}`,l=a[i];return d.jsxs("div",{className:"monthly-day-cell "+(c===r?"today":""),onClick:()=>t(c),children:[d.jsx("div",{className:"monthly-date-num",children:i}),l&&d.jsx("img",{ref:S,"data-src":l.thumbnailUrl,className:"monthly-thumbnail",alt:"Daily thumbnail"})]},c)})})()]})})(),"time"===c&&d.jsx(f,{currentMonth:a,goToDate:t}),"stats"===c&&d.jsx(j,{currentMonth:a,goToDate:t})]})]})}},Symbol.toStringTag,{value:"Module"}));export{x as M,m as a,g,y as h,d as j};

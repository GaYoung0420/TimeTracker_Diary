const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/monthly-BKqw5b9R.js","assets/react-vendor-DtX1tuCI.js"])))=>i.map(i=>d[i]);
import{g as e,a as t,j as a,h as s}from"./monthly-BKqw5b9R.js";import{a as n,r as l,R as i}from"./react-vendor-DtX1tuCI.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var o={},r=n;o.createRoot=r.createRoot,o.hydrateRoot=r.hydrateRoot;const c={};const d=new Map;function u({event:e,categories:t,onUpdate:s,onDelete:n,onClose:i}){const o=null===e.id,[r,c]=l.useState(e.title||""),[d,u]=l.useState(e.start_time||(e.start?e.start.split("T")[1].substring(0,5):"")),[m,h]=l.useState(e.end_time||(e.end?e.end.split("T")[1].substring(0,5):"")),[p,x]=l.useState(e.category_id),[g,v]=l.useState(e.description||""),[j,f]=l.useState(e.is_plan||!1);e.is_plan;return a.jsx("div",{className:"modal-overlay",onClick:i,children:a.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[a.jsx("h2",{children:o?"ì´ë²¤íŠ¸ ì¶”ê°€":"ì´ë²¤íŠ¸ ìˆ˜ì •"}),a.jsxs("form",{onSubmit:t=>{t.preventDefault();const a=5===d.length?`${d}:00`:d,n=5===m.length?`${m}:00`:m;s(e.id,{title:r,start_time:a,end_time:n,category_id:p,description:g,is_plan:j})},children:[a.jsxs("div",{className:"modal-scroll-content",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì œëª©"}),a.jsx("input",{type:"text",value:r,onChange:e=>c(e.target.value),placeholder:"ì´ë²¤íŠ¸ ì œëª©",required:!0})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì‹œìž‘ ì‹œê°„"}),a.jsx("input",{type:"time",value:d,onChange:e=>u(e.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì¢…ë£Œ ì‹œê°„"}),a.jsx("input",{type:"time",value:m,onChange:e=>h(e.target.value),required:!0})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì¹´í…Œê³ ë¦¬"}),a.jsx("select",{value:p,onChange:e=>x(parseInt(e.target.value)),children:t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))})]}),a.jsx("div",{className:"form-group checkbox-group",children:a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:j,onChange:e=>f(e.target.checked)}),a.jsx("span",{className:"checkbox-text",children:"ê³„íš ì´ë²¤íŠ¸ë¡œ ì¶”ê°€"})]})}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì„¤ëª…"}),a.jsx("textarea",{value:g,onChange:e=>v(e.target.value),placeholder:"ì´ë²¤íŠ¸ ì„¤ëª… (ì„ íƒì‚¬í•­)",rows:3})]})]}),a.jsxs("div",{className:"modal-actions",children:[!o&&a.jsx("button",{type:"button",className:"btn-delete",onClick:()=>{window.confirm("ì´ ì´ë²¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&n(e.id)},children:"ì‚­ì œ"}),a.jsxs("div",{className:"modal-actions-right",children:[a.jsx("button",{type:"button",className:"btn-cancel",onClick:i,children:"ì·¨ì†Œ"}),a.jsx("button",{type:"submit",className:"btn-submit",children:o?"ì¶”ê°€":"ì €ìž¥"})]})]})]})]})})}function m({event:e,categories:t,position:s,onUpdate:n,onDelete:i,onClose:o}){const[r,c]=l.useState(e.title),[d,u]=l.useState(e.date||e.start.split("T")[0]),[m,h]=l.useState(e.start_time||e.start.split("T")[1].substring(0,5)),[p,x]=l.useState(e.date||e.end.split("T")[0]),[g,v]=l.useState(e.end_time||e.end.split("T")[1].substring(0,5)),[j,f]=l.useState(e.category_id),y=l.useRef(null);l.useEffect(()=>{var e;const t=null==(e=y.current)?void 0:e.querySelector('input[type="text"]');t&&(t.focus(),t.select())},[]),l.useEffect(()=>{const e=e=>{y.current&&!y.current.contains(e.target)&&N()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[r,d,m,p,g,j]);const N=()=>{const t=5===m.length?`${m}:00`:m,a=5===g.length?`${g}:00`:g;n(e.id,{title:r,start_time:t,end_time:a,date:d,category_id:j})};return a.jsxs("div",{ref:y,className:"event-edit-popup",style:{position:"absolute",left:`${s.x}px`,top:`${s.y}px`},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),N()):"Escape"===e.key&&o()},children:[a.jsx("div",{className:"popup-row",children:a.jsx("input",{type:"text",value:r,onChange:e=>c(e.target.value),placeholder:"ì´ë²¤íŠ¸ ì œëª©",className:"popup-title-input"})}),a.jsxs("div",{className:"popup-row time-row",children:[a.jsx("label",{style:{fontSize:"12px",color:"#666",width:"30px"},children:"ì‹œìž‘"}),a.jsx("input",{type:"date",value:d,onChange:e=>u(e.target.value),className:"popup-time-input",style:{flex:1.5}}),a.jsx("input",{type:"time",value:m,onChange:e=>h(e.target.value),className:"popup-time-input"})]}),a.jsxs("div",{className:"popup-row time-row",children:[a.jsx("label",{style:{fontSize:"12px",color:"#666",width:"30px"},children:"ì¢…ë£Œ"}),a.jsx("input",{type:"date",value:p,onChange:e=>x(e.target.value),className:"popup-time-input",style:{flex:1.5}}),a.jsx("input",{type:"time",value:g,onChange:e=>v(e.target.value),className:"popup-time-input"})]}),a.jsx("div",{className:"popup-row",children:a.jsx("select",{value:j,onChange:e=>f(parseInt(e.target.value)),className:"popup-category-select",children:t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))})}),a.jsxs("div",{className:"popup-actions",children:[a.jsx("button",{onClick:()=>{window.confirm("ì´ ì´ë²¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&i(e.id)},className:"popup-btn-delete",children:"ì‚­ì œ"}),a.jsx("button",{onClick:N,className:"popup-btn-save",children:"ì €ìž¥"})]})]})}function h({events:t,todos:n,categories:i,todoCategories:o,loading:r,currentDate:c,onCreateEvent:d,onUpdateEvent:h,onDeleteEvent:p,wakeSleepInfo:x}){const g=40,[v,j]=l.useState(!1),[f,y]=l.useState(null),[N,b]=l.useState(null),[S,C]=l.useState(null),[k,w]=l.useState(null),[D,T]=l.useState(!1),[E,I]=l.useState(!1),[_,$]=l.useState({x:0,y:0}),[R,M]=l.useState(!1),[P,L]=l.useState(null),[A,z]=l.useState(0),[F,O]=l.useState(null),[B,U]=l.useState(null),[q,Y]=l.useState(!1),[W,K]=l.useState(null),[V,H]=l.useState(null),[X,G]=l.useState(null),[Z,J]=l.useState(null),[Q,ee]=l.useState(null),te=l.useRef(null),ae=l.useRef(null),se=l.useRef(null),ne=l.useRef(null),le=l.useRef(null),[ie,oe]=l.useState(new Date);l.useEffect(()=>{const e=setInterval(()=>{oe(new Date)},6e4);return()=>clearInterval(e)},[]),l.useEffect(()=>{const e=e=>t=>{const a=document.getElementById(`timeline-hover-line-${e}`),s=te.current;if(!a||!s)return;const n=s.getBoundingClientRect(),l=t.clientY-n.top+s.scrollTop;a.style.top=l+"px",a.style.display="block"},t=e=>()=>{const t=document.getElementById(`timeline-hover-line-${e}`);t&&(t.style.display="none")},a=setTimeout(()=>{const a=document.querySelector(".plan-column"),s=document.querySelector(".actual-column");a&&(a.addEventListener("mousemove",e("plan")),a.addEventListener("mouseleave",t("plan"))),s&&(s.addEventListener("mousemove",e("actual")),s.addEventListener("mouseleave",t("actual")))},100);return()=>{clearTimeout(a);const s=document.querySelector(".plan-column"),n=document.querySelector(".actual-column");s&&(s.removeEventListener("mousemove",e("plan")),s.removeEventListener("mouseleave",t("plan"))),n&&(n.removeEventListener("mousemove",e("actual")),n.removeEventListener("mouseleave",t("actual")))}},[t,r]);const re=e=>e.touches&&e.touches.length>0?{clientY:e.touches[0].clientY}:e.changedTouches&&e.changedTouches.length>0?{clientY:e.changedTouches[0].clientY}:{clientY:e.clientY},ce=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,de=()=>{const e=new Date,t=e.getHours(),a=10*Math.floor(e.getMinutes()/10),s=`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`,n=`${String(t).padStart(2,"0")}:${String(a+30).padStart(2,"0")}`;w({id:null,title:"",start_time:s,end_time:n,category_id:i.length>0?i[0].id:null,description:"",is_plan:!1}),T(!0)},ue=(t,a)=>{if(ce())return;if(q)return;t.stopPropagation(),t.preventDefault(),I(!1),T(!1),w(null);const s=te.current.getBoundingClientRect(),{clientY:n}=re(t),l=n-s.top,i=e(c),[o,r]=a.start.split("T"),[d,u]=r.split(":").map(Number),m=new Date(a.start),h=new Date(a.end),p=Math.round((h-m)/6e4);let x;if(o<i)x=0;else{if(o>i)return;x=60*d+u}const v=l-x/60*g;M(!0),L(a),z(v),O(x),U(p)},me=(t,a,s)=>{if(ce())return;t.stopPropagation(),t.preventDefault(),I(!1),T(!1),w(null);const n=e(c),[l,i]=a.start.split("T"),[o,r]=a.end.split("T"),[d,u]=i.split(":").map(Number),[m,h]=r.split(":").map(Number);let p,x;if(l<n)p=0;else{if(l>n)return;p=60*d+u}if(o>n)x=1440+(60*m+h);else{if(o<n)return;x=60*m+h}Y(!0),K(s),H(a),G(p),J(x),M(!1),L(null)},he=(e,t)=>{if(ce())return;if(e.target.closest(".event-block-absolute"))return;const a=te.current.getBoundingClientRect(),{clientY:s}=re(e),n=s-a.top,l=Math.floor(n/g*60),i=10*Math.round(l/10);j(!0),y(t),b(i),C(i)},pe=l.useCallback(e=>q?(le.current&&cancelAnimationFrame(le.current),void(le.current=requestAnimationFrame(()=>{const t=te.current.getBoundingClientRect(),{clientY:a}=re(e),s=a-t.top,n=Math.floor(s/g*60),l=10*Math.round(n/10),i=Math.max(0,Math.min(2880,l));if("top"===W){if(i<Z-10){G(i);const t=Math.floor(i/60),a=i%60,s=Math.floor(Z/60),n=Z%60,l=`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`,o=`${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}`;ee({x:e.clientX||e.touches&&e.touches[0].clientX,y:e.clientY||e.touches&&e.touches[0].clientY,startTime:l,endTime:o})}}else if("bottom"===W&&i>X+10){J(i);const t=Math.floor(X/60),a=X%60,s=Math.floor(i/60),n=i%60,l=`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`,o=`${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}`;ee({x:e.clientX||e.touches&&e.touches[0].clientX,y:e.clientY||e.touches&&e.touches[0].clientY,startTime:l,endTime:o})}}))):R?(ne.current&&cancelAnimationFrame(ne.current),void(ne.current=requestAnimationFrame(()=>{const t=te.current.getBoundingClientRect(),{clientY:a}=re(e),s=a-t.top,n=Math.floor((s-A)/g*60),l=10*Math.round(n/10),i=Math.max(0,l);if(F!==i){O(i);const t=i+B,a=Math.floor(i/60),s=i%60,n=Math.floor(t/60),l=t%60,o=`${String(a).padStart(2,"0")}:${String(s).padStart(2,"0")}`,r=`${String(n).padStart(2,"0")}:${String(l).padStart(2,"0")}`;ee({x:e.clientX||e.touches&&e.touches[0].clientX,y:e.clientY||e.touches&&e.touches[0].clientY,startTime:o,endTime:r})}}))):void(v&&(ae.current&&cancelAnimationFrame(ae.current),ae.current=requestAnimationFrame(()=>{const t=te.current.getBoundingClientRect(),{clientY:a}=re(e),s=a-t.top,n=Math.floor(s/g*60),l=10*Math.round(n/10);se.current!==l&&(se.current=l,C(l))}))),[v,R,q,W,X,Z,g,A,F,B]),xe=l.useCallback(async()=>{if(ee(null),q&&V){le.current&&(cancelAnimationFrame(le.current),le.current=null);const t=e(c),[a,s]=V.start.split("T"),[n,l]=V.end.split("T");let i={};if("top"===W){let e=Math.floor(X/60),a=X%60,s=t;if(X<0)return Y(!1),K(null),H(null),G(null),void J(null);i={start_time:`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}:00`,date:s}}else if("bottom"===W){let e=Math.floor(Z/60),t=Z%60;Z>=1440&&(e=Math.floor(Z/60)-24,t=Z%60);i={end_time:`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}:00`}}try{await h(V.id,i)}catch(k){}return Y(!1),K(null),H(null),G(null),void J(null)}if(R&&P){ne.current&&(cancelAnimationFrame(ne.current),ne.current=null);const t=e(c),[a]=P.start.split("T"),s=F,n=s+B;if(s<0)return M(!1),L(null),O(null),void U(null);let l=e(c),i=Math.floor(s/60),o=s%60,r=Math.floor(n/60),d=n%60;n>=1440&&(r=Math.floor(n/60)-24,d=n%60);const u=`${String(i).padStart(2,"0")}:${String(o).padStart(2,"0")}:00`,m=`${String(r).padStart(2,"0")}:${String(d).padStart(2,"0")}:00`,[p,x]=P.start.split("T"),[g,v]=x.split(":").map(Number);let j;if(j=p<t?0:60*g+v,s!==j)try{const e={start_time:u,end_time:m,date:l};await h(P.id,e)}catch(k){}return M(!1),L(null),O(null),void U(null)}if(!v)return;ae.current&&(cancelAnimationFrame(ae.current),ae.current=null);const t=Math.min(N,S),a=Math.max(N,S);if(a-t<10)return j(!1),void(se.current=null);const s=Math.floor(t/60),n=t%60,l=Math.floor(a/60),o=a%60,r=`${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}:00`,u=`${String(l).padStart(2,"0")}:${String(o).padStart(2,"0")}:00`,m="plan"===f,p=i.find(e=>e.id)||i[0],x=p?p.id:null;try{const e=await d("ìƒˆ ì´ë²¤íŠ¸",r,u,x,m,"");if(e&&te.current){const a=te.current.getBoundingClientRect(),s=t/60*g,n=a.width/3;w(e),$({x:"plan"===f?n+10:a.width-10,y:s+220}),I(!0)}}catch(k){}j(!1),b(null),C(null),y(null),se.current=null},[v,R,q,P,V,F,X,Z,N,S,f,i,d,h]),ge=(t,n=!1)=>{const l=e(c),[i,o]=t.start.split("T"),[r,d]=t.end.split("T");let u,m;if(i<l)u=0;else{if(i>l)return null;{const[e,t]=o.split(":").map(Number);u=60*e+t}}if(r>l)m=1440;else{if(r<l)return null;{const[e,t]=d.split(":").map(Number);m=60*e+t}}const h=m-u;if(h<=0)return null;const p=R&&P&&P.id===t.id,x=q&&V&&V.id===t.id;let v,j;x?(v=X,j=Z):p?(v=F,j=F+h):(v=u,j=m);const f=v/60*g,y=(j-v)/60*g,N=(t.category||{color:"#9E9E9E"}).color,b=s(N,p?.6:n?.25:.35);let S,C;if(p||x){const e=Math.floor(v/60),t=v%60,a=Math.floor(j/60),s=j%60;S=`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}`,C=`${String(a).padStart(2,"0")}:${String(s).padStart(2,"0")}`}else S=o.substring(0,5),C=d.substring(0,5);const k=Math.floor(h/60),D=h%60,E=k>0?`${k}ì‹œê°„ ${D}ë¶„`:`${D}ë¶„`,_=h<=50;return a.jsxs("div",{className:"event-block-absolute",style:{background:b,color:"#000",top:`${f}px`,height:`${Math.max(y,20)}px`,cursor:n?"default":p?"grabbing":"grab",opacity:n?.9:p?.8:1,zIndex:p?1e3:1,transition:p?"none":"top 0.1s ease-out",border:n?`2px dashed ${N}`:void 0,padding:_?"1px 4px":"6px 8px",display:"flex",flexDirection:"column",justifyContent:_?"center":"flex-start"},onMouseDown:e=>!n&&ue(e,t),onTouchStart:e=>!n&&ue(e,t),onClick:e=>{R||q||n||((e,t)=>{if(te.current)if(w(e),ce())T(!0);else{const e=te.current.getBoundingClientRect(),a=t.clientX-e.left,s=t.clientY-e.top;$({x:a+10>e.width/2?a+150:a+10,y:s+220>e.height?s-30:s+10}),I(!0)}})(t,e)},title:n?`ðŸ“‹ ${t.title}\n${S} - ${C}\n(í• ì¼ ê³„íš)`:`${t.title}\n${S} - ${C}\n${E}`,children:[!n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"resize-handle resize-handle-top",style:{position:"absolute",top:0,left:0,right:0,height:"6px",cursor:"ns-resize",zIndex:10},onMouseDown:e=>me(e,t,"top"),onTouchStart:e=>me(e,t,"top"),onClick:e=>e.stopPropagation()}),a.jsx("div",{className:"resize-handle resize-handle-bottom",style:{position:"absolute",bottom:0,left:0,right:0,height:"6px",cursor:"ns-resize",zIndex:10},onMouseDown:e=>me(e,t,"bottom"),onTouchStart:e=>me(e,t,"bottom"),onClick:e=>e.stopPropagation()})]}),a.jsxs("div",{className:"event-title",style:{fontSize:_?"10px":"11px",lineHeight:_?"1.1":"1.4",whiteSpace:_?"nowrap":"normal",overflow:"hidden",textOverflow:"ellipsis"},children:[n?"ðŸ“‹ ":"",t.title,_&&a.jsxs("span",{style:{marginLeft:"4px",fontSize:"9px",opacity:.8,fontWeight:"normal"},children:[S,"-",C]})]}),!_&&a.jsxs("div",{className:"event-time",children:[S," - ",C]})]},t.id)},ve=()=>{if(!v)return null;const e=Math.min(N,S),t=Math.max(N,S),s=e/60*g,n=(t-e)/60*g,l=Math.floor(e/60),i=e%60,o=Math.floor(t/60),r=t%60,c=`${String(l).padStart(2,"0")}:${String(i).padStart(2,"0")}`,d=`${String(o).padStart(2,"0")}:${String(r).padStart(2,"0")}`,u=t-e<=50;return a.jsxs("div",{className:"event-block-absolute",style:{background:"rgba(66, 133, 244, 0.3)",border:"2px dashed #4285F4",top:`${s}px`,height:`${Math.max(n,20)}px`,pointerEvents:"none",padding:u?"1px 4px":"6px 8px",display:"flex",flexDirection:"column",justifyContent:u?"center":"flex-start"},children:[a.jsxs("div",{className:"event-title",style:{fontSize:u?"10px":"11px",lineHeight:u?"1.1":"1.4",whiteSpace:u?"nowrap":"normal",overflow:"hidden",textOverflow:"ellipsis"},children:["ìƒˆ ì´ë²¤íŠ¸",u&&a.jsxs("span",{style:{marginLeft:"4px",fontSize:"9px",opacity:.8,fontWeight:"normal"},children:[c,"-",d]})]}),!u&&a.jsxs("div",{className:"event-time",children:[c," - ",d]})]})},je=l.useMemo(()=>n&&0!==n.length?n.filter(e=>e.scheduled_time).map(t=>{let a=null;if(t.category_id&&(a=i.find(e=>e.id==t.category_id)),!a&&t.todo_category_id&&o){const e=o.find(e=>e.id==t.todo_category_id);e&&e.event_category_id&&(a=i.find(t=>t.id==e.event_category_id))}a||(a={color:"#9E9E9E",name:"ê¸°íƒ€"});const s=e(c);let n=t.scheduled_time;5===n.length&&(n+=":00");const l=parseInt(t.duration)||30,[r,d]=n.split(":").map(Number),u=60*r+d+l,m=Math.floor(u/60)%24,h=u%60,p=`${String(m).padStart(2,"0")}:${String(h).padStart(2,"0")}:00`;return{id:`todo-${t.id}`,title:`ðŸ“ ${t.text}`,start:`${s}T${n}`,end:`${s}T${p}`,category:a,category_id:a.id,is_plan:!0,is_todo:!0}}):[],[n,i,o,c]),{planEvents:fe,actualEvents:ye}=l.useMemo(()=>({planEvents:[...t.filter(e=>!0===e.is_plan),...je],actualEvents:t.filter(e=>!1===e.is_plan)}),[t,je]);return r?a.jsx("div",{className:"timeline-wrapper",children:a.jsxs("div",{className:"timeline-loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"ì´ë²¤íŠ¸ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]})}):a.jsxs(a.Fragment,{children:[(()=>{const{wakeTime:e,sleepTime:t}=x;return a.jsxs("div",{className:"wake-sleep-container",children:[a.jsxs("div",{className:"wake-sleep-item",children:["ðŸŒ… ê¸°ìƒ: ",a.jsx("span",{className:"time-value",children:e})]}),a.jsxs("div",{className:"wake-sleep-item",children:["ðŸŒ™ ì·¨ì¹¨: ",a.jsx("span",{className:"time-value",children:t})]}),a.jsx("button",{className:"add-event-button-mobile",onClick:de,title:"ì´ë²¤íŠ¸ ì¶”ê°€",children:"âž• ì´ë²¤íŠ¸ ì¶”ê°€"})]})})(),!1,a.jsxs("div",{className:"timeline-grid",children:[a.jsxs("div",{className:"timeline-header",children:[a.jsx("div",{children:"ê³„íš"}),a.jsx("div",{children:"ì‹œê°„"}),a.jsx("div",{children:"ì‹¤ì œ"})]}),a.jsxs("div",{ref:te,className:"timeline-wrapper",style:{minHeight:"960px",position:"relative"},onMouseMove:pe,onMouseUp:xe,onTouchMove:pe,onTouchEnd:xe,onMouseLeave:()=>{ae.current&&(cancelAnimationFrame(ae.current),ae.current=null),ne.current&&(cancelAnimationFrame(ne.current),ne.current=null),le.current&&(cancelAnimationFrame(le.current),le.current=null),j(!1),M(!1),L(null),O(null),U(null),Y(!1),K(null),H(null),G(null),J(null),ee(null),se.current=null},children:[a.jsxs("div",{className:"timeline-columns",children:[a.jsxs("div",{className:"timeline-column plan-column",onMouseDown:e=>he(e,"plan"),onTouchStart:e=>he(e,"plan"),style:{position:"relative"},children:[a.jsx("div",{className:"timeline-hover-line",id:"timeline-hover-line-plan"}),fe.map(e=>ge(e,e.is_todo)),v&&"plan"===f&&ve()]}),a.jsx("div",{className:"timeline-column time-column"}),a.jsxs("div",{className:"timeline-column actual-column",onMouseDown:e=>he(e,"actual"),onTouchStart:e=>he(e,"actual"),style:{position:"relative"},children:[a.jsx("div",{className:"timeline-hover-line",id:"timeline-hover-line-actual"}),ye.map(e=>ge(e,!1)),v&&"actual"===f&&ve()]})]}),a.jsx("div",{className:"time-markers",children:Array.from({length:24},(s,n)=>{const{wakeTime:l,wakeDateTime:i}=x,o=e(c);let r=!1;if(i&&"-"!==i&&null!==i){const e=i.split("T")[0],t=parseInt(i.split("T")[1].split(":")[0]);r=e===o&&t===n}let d=!1;const u=t.filter(e=>"ìž "===e.title&&e.category&&e.category.name&&e.category.name.includes("ìž ")&&!1===e.is_plan);for(const e of u){let t;if(e.start&&e.start.includes("T")?t=parseInt(e.start.split("T")[1].split(":")[0]):e.start_time&&(t=parseInt(e.start_time.split(":")[0])),t===n){d=!0;break}}const m={color:r?"#e03131":d?"#1971c2":void 0,fontWeight:r||d?"bold":void 0,fontSize:r||d?16:void 0,backgroundColor:r?"#ffe0e0":d?"#e0f2ff":void 0,borderRadius:r||d?"4px":void 0,padding:r||d?"2px 4px":void 0};return a.jsxs("div",{className:"time-marker-row",style:{height:"40px"},children:[a.jsx("div",{}),a.jsx("div",{className:"time-marker-label",style:m,children:String(n).padStart(2,"0")}),a.jsx("div",{})]},n)})}),e(c)===e(ie)&&a.jsx("div",{className:"current-time-indicator",style:{position:"absolute",top:(60*ie.getHours()+ie.getMinutes())/60*g+"px",left:0,right:0,height:"2px",backgroundColor:"red",opacity:.2,zIndex:20,pointerEvents:"none"},children:a.jsx("div",{style:{position:"absolute",left:"-5px",top:"-4px",width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"red"}})})]})]}),E&&k&&a.jsx(m,{event:k,categories:i,position:_,onUpdate:async(e,t)=>{try{await h(e,t),I(!1),w(null)}catch(a){}},onDelete:async e=>{try{await p(e),I(!1),w(null)}catch(t){}},onClose:()=>{I(!1),w(null)}}),D&&k&&a.jsx(u,{event:k,categories:i,onUpdate:async(e,t)=>{try{if(null===e){const{title:e,start_time:a,end_time:s,category_id:n,description:l,is_plan:i}=t;await d(e,a,s,n,i,l)}else await h(e,t);T(!1),w(null)}catch(a){}},onDelete:async e=>{try{await p(e),T(!1),w(null)}catch(t){}},onClose:()=>{T(!1),w(null)}})]})}const p=1500;function x({todoText:e,pomodoroCount:t,onComplete:s,onClose:n}){const[i,o]=l.useState(p),[r,c]=l.useState(!1),[d,u]=l.useState(!1),[m,h]=l.useState(!1),[x,g]=l.useState(!1),v=l.useRef(null),j=l.useRef(null);l.useEffect(()=>(r&&!d?v.current=setInterval(()=>{o(e=>e<=1?(clearInterval(v.current),c(!1),s(),p):e-1)},1e3):v.current&&clearInterval(v.current),()=>{v.current&&clearInterval(v.current)}),[r,d,s]),l.useEffect(()=>{if(j.current){const e=document.createElement("canvas");e.width=400,e.height=200;const t=e.getContext("2d"),a=()=>{t.clearRect(0,0,e.width,e.height),t.fillStyle="#ffffff",t.fillRect(0,0,e.width,e.height),t.fillStyle="#333333",t.font="bold 64px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(f(i),e.width/2,e.height/2),x&&requestAnimationFrame(a)};if(x){const t=e.captureStream(30);j.current.srcObject=t,a()}}},[i,x]);const f=e=>{const t=Math.floor(e/60),a=e%60;return`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`},y=()=>{c(!1),u(!1),o(p)},N=(p-i)/p*100;return a.jsx("div",{className:"pomodoro-overlay",children:a.jsxs("div",{className:"pomodoro-modal "+(m?"fullscreen":""),children:[a.jsx("button",{className:"pomodoro-close",onClick:n,children:"Ã—"}),a.jsxs("div",{className:"pomodoro-header",children:[a.jsx("div",{className:"pomodoro-todo-title",children:e}),a.jsxs("div",{className:"pomodoro-count-display",children:["ì™„ë£Œí•œ ë½€ëª¨ë„ë¡œ: ",t,"ê°œ ðŸ…"]})]}),a.jsxs("div",{className:"pomodoro-circle-container",children:[a.jsxs("svg",{className:"pomodoro-circle",viewBox:"0 0 200 200",children:[a.jsx("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"#e0e0e0",strokeWidth:"10"}),a.jsx("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"#ff6b6b",strokeWidth:"10",strokeDasharray:""+2*Math.PI*90,strokeDashoffset:""+2*Math.PI*90*(1-N/100),transform:"rotate(-90 100 100)",style:{transition:"stroke-dashoffset 1s linear"}})]}),a.jsx("div",{className:"pomodoro-time",children:f(i)})]}),a.jsx("div",{className:"pomodoro-controls",children:r?d?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"pomodoro-btn pomodoro-btn-primary",onClick:()=>{u(!1)},children:"ìž¬ê°œ"}),a.jsx("button",{className:"pomodoro-btn pomodoro-btn-secondary",onClick:y,children:"ì´ˆê¸°í™”"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"pomodoro-btn pomodoro-btn-secondary",onClick:()=>{u(!0)},children:"ì¼ì‹œì •ì§€"}),a.jsx("button",{className:"pomodoro-btn pomodoro-btn-secondary",onClick:y,children:"ì´ˆê¸°í™”"})]}):a.jsx("button",{className:"pomodoro-btn pomodoro-btn-primary",onClick:()=>{c(!0),u(!1)},children:"ì‹œìž‘"})}),a.jsxs("div",{className:"pomodoro-actions",children:[a.jsx("button",{className:"pomodoro-action-btn",onClick:()=>{h(!m)},children:m?"ì¢…ë£Œ":"ì „ì²´í™”ë©´"}),a.jsx("button",{className:"pomodoro-action-btn",onClick:async()=>{if(!x&&j.current)try{j.current.readyState<2&&await new Promise(e=>{j.current.onloadedmetadata=e}),await j.current.requestPictureInPicture(),g(!0)}catch(e){}else document.pictureInPictureElement&&(await document.exitPictureInPicture(),g(!1))},children:x?"PIP ì¢…ë£Œ":"PIP"})]}),a.jsx("video",{ref:j,style:{display:"none"},autoPlay:!0,muted:!0,playsInline:!0})]})})}function g({todos:e,categories:s,todoCategories:n,currentDate:i,onAdd:o,onUpdate:r,onDelete:c,onReorder:d,onOpenTodoCategoryManager:u}){var m,h;const[p,g]=l.useState(""),[v,j]=l.useState(!1),[f,y]=l.useState(null),[N,b]=l.useState(null),[S,C]=l.useState(""),[k,w]=l.useState(""),[D,T]=l.useState(null),[E,I]=l.useState(""),[_,$]=l.useState(null),[R,M]=l.useState(null),[P,L]=l.useState(""),[A,z]=l.useState(""),[F,O]=l.useState(null),[B,U]=l.useState(null),q=e=>{if(!i||e.completed)return!1;const t=new Date;t.setHours(0,0,0,0);const a=new Date(i);return a.setHours(0,0,0,0),a<t},Y=()=>{p.trim()&&(o(p.trim(),null,N,S||null,k?parseInt(k):null),g(""),y(null),b(null),C(""),w(""),j(!1))},W=e=>{E.trim()&&r(e,{text:E.trim(),category_id:_,todo_category_id:R,scheduled_time:P||null,duration:A?parseInt(A):null}),T(null),I(""),$(null),M(null),L(""),z("")},K=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},V=()=>{O(null)},H=[...e].sort((e,t)=>e.order-t.order),X=e=>s.find(t=>t.id===e),G=e=>null==n?void 0:n.find(t=>t.id===e),Z=async(e,a)=>{if(a)try{const s=await t.completeTodo(e);s.success&&s.event?window.location.reload():r(e,{completed:a})}catch(s){r(e,{completed:a})}else r(e,{completed:a})};return a.jsxs("div",{className:"todo-container",children:[a.jsxs("div",{className:"section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"âœ… ì˜¤ëŠ˜ í•  ì¼"}),a.jsx("button",{className:"btn-category-settings-small",onClick:u,title:"íˆ¬ë‘ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬",children:"âš™ï¸"})]}),a.jsxs("div",{className:"todo-input-group",style:{position:"relative"},children:[a.jsx("input",{type:"text",className:"todo-input",placeholder:"í•  ì¼ì„ ìž…ë ¥í•˜ì„¸ìš”...",value:p,onChange:e=>g(e.target.value),onKeyPress:e=>{"Enter"===e.key&&Y()}}),a.jsx("button",{className:"btn-settings-popup",onClick:()=>j(!v),style:{background:v?"#f0f0f0":"white",border:"1px solid #e9e9e7",borderRadius:"4px",cursor:"pointer",fontSize:"16px",color:"#666",padding:"0 10px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},title:"ìƒì„¸ ì„¤ì •",children:"âž•"}),a.jsx("button",{className:"btn",onClick:Y,children:"ì¶”ê°€"}),v&&a.jsxs("div",{className:"todo-settings-popup",style:{position:"absolute",top:"100%",right:"0",marginTop:"8px",background:"white",border:"1px solid #e0e0e0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"16px",zIndex:100,width:"280px"},children:[a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:"íˆ¬ë‘ ì¹´í…Œê³ ë¦¬"}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:n&&n.length>0?n.map(e=>a.jsx("button",{className:"category-chip-small "+(N===e.id?"selected":""),style:{backgroundColor:N===e.id?e.color||"#4a9eff":"#f0f0f0",color:"#37352f",border:"none",padding:"4px 8px",borderRadius:"4px",fontSize:"11px",cursor:"pointer"},onClick:()=>b(N===e.id?null:e.id),children:e.name},e.id)):a.jsx("div",{style:{fontSize:"11px",color:"#999"},children:"ì¹´í…Œê³ ë¦¬ ì—†ìŒ"})})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:"ì‹œìž‘ ì‹œê°„"}),a.jsx("input",{type:"time",value:S,onChange:e=>C(e.target.value),style:{width:"100%",padding:"6px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:"12px",color:"#666",marginBottom:"4px"},children:"ì†Œìš” ì‹œê°„ (ë¶„)"}),a.jsx("input",{type:"number",value:k,onChange:e=>w(e.target.value),placeholder:"30",min:"1",style:{width:"100%",padding:"6px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px"}})]})]})]}),a.jsx("ul",{className:"todo-list",children:0===H.length?a.jsx("li",{style:{textAlign:"left",fontSize:"13px",color:"#9b9a97",padding:"8px 0",listStyle:"none"},children:"í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤"}):H.map(t=>{return a.jsxs("li",{className:"todo-item "+((null==F?void 0:F.id)===t.id?"dragging":""),draggable:D!==t.id,onDragStart:e=>((e,t)=>{O(t),e.dataTransfer.effectAllowed="move"})(e,t),onDragOver:K,onDrop:a=>((t,a)=>{if(t.preventDefault(),!F||F.id===a.id)return void O(null);const s=[...e].sort((e,t)=>e.order-t.order),n=s.findIndex(e=>e.id===F.id),l=s.findIndex(e=>e.id===a.id);if(-1===n||-1===l)return void O(null);const i=[...s],[o]=i.splice(n,1);i.splice(l,0,o);const r=i.map((e,t)=>({id:e.id,order:t}));d(r),O(null)})(a,t),onDragEnd:V,children:[a.jsx("span",{className:"todo-drag-handle",children:"â‹®"}),q(t)?a.jsx("div",{className:"todo-checkbox overdue-arrow",onClick:()=>Z(t.id,!t.completed),style:{width:"20px",height:"20px",cursor:"pointer",flexShrink:0,margin:0,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #999",borderRadius:"3px",fontSize:"14px",color:"#fe7f65ff",background:"#fff",userSelect:"none",fontWeight:"bold"},title:"ë¯¸ì™„ë£Œ (í´ë¦­í•˜ì—¬ ì™„ë£Œ)",children:"â†’"}):a.jsx("input",{type:"checkbox",className:"todo-checkbox",checked:t.completed,onChange:()=>Z(t.id,!t.completed)}),D===t.id?a.jsxs("div",{className:"todo-edit-card compact",children:[a.jsxs("div",{className:"todo-edit-top-row",children:[a.jsx("input",{type:"text",className:"todo-edit-input-compact",value:E,onChange:e=>I(e.target.value),onKeyDown:e=>{"Enter"===e.key&&W(t.id)},autoFocus:!0,placeholder:"í•  ì¼ ìž…ë ¥"}),a.jsx("button",{className:"btn-save-compact",onClick:()=>W(t.id),children:"ì €ìž¥"})]}),a.jsxs("div",{className:"todo-edit-bottom-row",children:[a.jsx("div",{className:"todo-category-scroll",children:n&&n.length>0?n.map(e=>a.jsx("button",{className:"category-chip-micro "+(R===e.id?"selected":""),style:R===e.id?{backgroundColor:e.color||"#4a9eff",color:"#37352f",borderColor:e.color||"#4a9eff"}:{},onClick:t=>{t.stopPropagation(),M(R===e.id?null:e.id)},title:e.name,children:e.name},e.id)):a.jsx("span",{className:"no-cat-msg",children:"ì¹´í…Œê³ ë¦¬ ì—†ìŒ"})}),a.jsxs("div",{className:"todo-time-compact-group",children:[a.jsx("input",{type:"time",className:"todo-edit-time-compact",value:P,onChange:e=>L(e.target.value),title:"ì‹œìž‘ ì‹œê°„"}),a.jsxs("div",{className:"duration-wrapper",children:[a.jsx("input",{type:"number",className:"todo-edit-duration-compact",value:A,onChange:e=>z(e.target.value),placeholder:"ë¶„",title:"ì†Œìš” ì‹œê°„(ë¶„)"}),a.jsx("span",{className:"unit-text",children:"m"})]})]})]})]}):a.jsxs("div",{className:"todo-content",children:[a.jsxs("span",{className:"todo-text "+(t.completed?"completed":""),onDoubleClick:()=>(e=>{T(e.id),I(e.text),$(e.category_id||null),M(e.todo_category_id||null),L(e.scheduled_time||""),z(e.duration||"")})(t),children:[t.text,t.scheduled_time&&a.jsxs("span",{style:{marginLeft:"8px",fontSize:"11px",color:"#666"},children:["â° ",t.scheduled_time.slice(0,5)]}),t.duration&&a.jsxs("span",{style:{marginLeft:"4px",fontSize:"11px",color:"#666"},children:["(",t.duration,"ë¶„)"]})]}),t.category_id&&X(t.category_id)&&a.jsx("span",{className:"todo-category-badge",style:{backgroundColor:X(t.category_id).color,color:"#37352f"},children:X(t.category_id).name}),t.todo_category_id&&G(t.todo_category_id)&&a.jsx("span",{className:"todo-category-badge",style:{backgroundColor:G(t.todo_category_id).color||"#4a9eff",color:"#37352f"},children:G(t.todo_category_id).name}),(s=t.pomodoro_count,s&&0!==s?a.jsx("div",{className:"pomodoro-tomatoes",style:{display:"flex",gap:"4px",marginLeft:"8px"},children:Array.from({length:s}).map((e,t)=>a.jsx("img",{src:"/assets/pomo-BNnBQd7t.svg",alt:"pomodoro",width:"20",height:"20",style:{display:"block"}},t))}):null),a.jsx("button",{className:"pomodoro-start-btn",onClick:()=>{return e=t.id,void U(e);var e},title:"ë½€ëª¨ë„ë¡œ ì‹œìž‘",children:"ðŸ…"})]}),a.jsx("button",{className:"todo-delete",onClick:()=>c(t.id),children:"Ã—"})]},t.id);var s})}),B&&a.jsx(x,{todoId:B,todoText:(null==(m=H.find(e=>e.id===B))?void 0:m.text)||"",pomodoroCount:(null==(h=H.find(e=>e.id===B))?void 0:h.pomodoro_count)||0,onComplete:()=>(async e=>{try{(await t.incrementPomodoro(e)).success&&r(e,{})}catch(a){}})(B),onClose:()=>{U(null)}})]})}function v({routines:e,routineChecks:t,onToggle:s,onAdd:n,onUpdate:i,onDelete:o,onReorder:r}){const[c,d]=l.useState(""),[u,m]=l.useState(!1),[h,p]=l.useState(null),[x,g]=l.useState(""),[v,j]=l.useState(null),f=()=>{c.trim()&&(n(c.trim()),d(""),m(!1))},y=()=>{x.trim()&&i(h,{text:x.trim()}),p(null),g("")},N=()=>{p(null),g("")},b=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},S=()=>{j(null)},C=[...e].sort((e,t)=>e.order-t.order);return a.jsxs("div",{className:"routine-container",children:[a.jsxs("div",{className:"section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"ðŸ” ì˜¤ëŠ˜ì˜ ë£¨í‹´"}),a.jsx("button",{className:"btn-category-settings-small",onClick:()=>m(!0),title:"ìƒˆ ë£¨í‹´ ì¶”ê°€",children:"+"})]}),a.jsx("div",{className:"routine-grid",children:0===C.length?a.jsx("div",{style:{fontSize:"13px",color:"#9b9a97"},children:"ë£¨í‹´ì´ ì—†ìŠµë‹ˆë‹¤"}):C.map(n=>{const l=t[n.id]||!1,i=h===n.id;return a.jsx("div",{className:`routine-card ${l?"completed":""} ${(null==v?void 0:v.id)===n.id?"dragging":""}`,onClick:()=>!i&&s(n.id,!l),draggable:!i,onDragStart:e=>((e,t)=>{j(t),e.dataTransfer.effectAllowed="move"})(e,n),onDragOver:b,onDrop:t=>((t,a)=>{if(t.preventDefault(),!v||v.id===a.id)return void j(null);const s=[...e].sort((e,t)=>e.order-t.order),n=s.findIndex(e=>e.id===v.id),l=s.findIndex(e=>e.id===a.id);if(-1===n||-1===l)return void j(null);const i=[...s],[o]=i.splice(n,1);i.splice(l,0,o);const c=i.map((e,t)=>({id:e.id,order:t}));r(c),j(null)})(t,n),onDragEnd:S,children:i?a.jsxs("div",{className:"routine-edit-mode",onClick:e=>e.stopPropagation(),children:[a.jsx("input",{type:"text",className:"routine-edit-input",value:x,onChange:e=>g(e.target.value),onKeyPress:e=>{"Enter"===e.key&&y(),"Escape"===e.key&&N()},autoFocus:!0}),a.jsxs("div",{className:"routine-edit-actions",children:[a.jsx("button",{className:"routine-edit-btn save",onClick:y,children:"âœ“"}),a.jsx("button",{className:"routine-edit-btn cancel",onClick:N,children:"âœ•"})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"routine-title",children:n.text}),a.jsxs("div",{className:"routine-actions",children:[a.jsx("button",{className:"routine-action-btn edit",onClick:e=>((e,t)=>{t.stopPropagation(),p(e.id),g(e.text)})(n,e),title:"ìˆ˜ì •",children:"âœŽ"}),a.jsx("button",{className:"routine-action-btn delete",onClick:e=>((e,t)=>{t.stopPropagation(),confirm("ì´ ë£¨í‹´ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&o(e)})(n.id,e),title:"ì‚­ì œ",children:"Ã—"})]}),a.jsx("div",{className:"routine-check",children:l?"âœ“":""})]})},n.id)})}),u&&a.jsx("div",{className:"routine-modal-overlay",onClick:()=>m(!1),children:a.jsxs("div",{className:"routine-modal-content",onClick:e=>e.stopPropagation(),children:[a.jsx("h3",{className:"routine-modal-title",children:"ìƒˆ ë£¨í‹´ ì¶”ê°€"}),a.jsx("div",{className:"form-group",children:a.jsx("input",{type:"text",className:"routine-modal-input",placeholder:"ë£¨í‹´ ì´ë¦„ ìž…ë ¥...",value:c,onChange:e=>d(e.target.value),onKeyPress:e=>{"Enter"===e.key&&f()},autoFocus:!0})}),a.jsxs("div",{className:"routine-modal-actions",children:[a.jsx("button",{className:"routine-btn-cancel",onClick:()=>m(!1),children:"ì·¨ì†Œ"}),a.jsx("button",{className:"routine-btn-save",onClick:f,children:"ì¶”ê°€"})]})]})})]})}function j({selectedMood:e,onSelect:t}){return a.jsxs("div",{className:"mood-container",children:[a.jsx("div",{className:"section-header",children:"ðŸ˜Š ì˜¤ëŠ˜ì˜ ê¸°ë¶„"}),a.jsx("div",{className:"mood-selector",children:[{value:"bad",emoji:"ðŸ˜¢",label:"Bad"},{value:"soso",emoji:"ðŸ˜",label:"So-So"},{value:"good",emoji:"ðŸ˜Š",label:"Good"}].map(s=>a.jsxs("button",{className:"mood-btn "+(e===s.value?"selected":""),"data-mood":s.value,onClick:()=>t(s.value),children:[a.jsx("span",{className:"mood-emoji",children:s.emoji}),a.jsx("span",{className:"mood-label",children:s.label})]},s.value))})]})}const f="âœ¦[ì‹¤ì œ] ì˜¤ëŠ˜ ì‹¤ì œë¡œ í•œ ê²ƒ: :\nâœ§[ì—ë„ˆì§€] 0~10 ì¤‘:\nâœ§[ì¹­ì°¬] ì¹­ì°¬í•˜ê¸° :\n-------------------\nâœ§Keep           :\nâœ¦Problem        :\nâœ§TRY      :\n";function y({value:e,onSave:t}){const[s,n]=l.useState(e||f);l.useEffect(()=>{n(e||f)},[e]);return a.jsxs("div",{className:"reflection-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{children:"ðŸ“ ì˜¤ëŠ˜ì˜ íšŒê³ "}),s!==f&&a.jsx("button",{className:"template-btn",onClick:()=>{n(f)},title:"ê¸°ë³¸ í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸°",children:"ðŸ“‹ í…œí”Œë¦¿"})]}),a.jsx("textarea",{className:"reflection-textarea",placeholder:"ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ëŒì•„ë³´ë©°...",value:s,onChange:e=>n(e.target.value)}),a.jsx("button",{className:"btn",style:{marginTop:"12px",width:"100%"},onClick:()=>{t(s),alert("íšŒê³ ê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤!")},children:"ì €ìž¥í•˜ê¸°"})]})}function N({currentDate:t,images:s,onImageUploaded:n,onImageDeleted:i}){const[o,r]=l.useState(!1),c=e(t);return a.jsxs("div",{className:"image-upload-section",children:[a.jsx("div",{className:"section-header",children:"ðŸ“· ì˜¤ëŠ˜ì˜ ì‚¬ì§„"}),a.jsxs("div",{className:"images-grid",children:[s&&s.length>0&&s.map(e=>a.jsxs("div",{className:"image-item",children:[a.jsx("img",{src:e.view_url,alt:e.file_name,className:"image-thumbnail"}),a.jsx("button",{className:"image-delete-btn",onClick:()=>(async e=>{if(confirm("ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{const t=await fetch(`/api/images/${e}`,{method:"DELETE"}),a=await t.json();a.success?i(e):alert("ì‚­ì œ ì‹¤íŒ¨: "+a.error)}catch(t){alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}})(e.id),title:"ì‚­ì œ",children:"Ã—"})]},e.id)),a.jsxs("label",{className:"image-upload-card",children:[a.jsx("div",{className:"upload-icon",children:"+"}),a.jsx("div",{className:"upload-text",children:o?"ì—…ë¡œë“œ ì¤‘...":"ì‚¬ì§„ ì¶”ê°€"}),a.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:async e=>{const t=Array.from(e.target.files);if(0!==t.length){for(const e of t){if(!e.type.startsWith("image/"))return void alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.");if(e.size>5242880)return void alert(`${e.name}: íŒŒì¼ í¬ê¸°ëŠ” 5MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)}r(!0);try{for(const e of t){const t=new FormData;t.append("image",e),t.append("date",c);const a=await fetch("/api/images/upload",{method:"POST",body:t}),s=await a.json();if(!s.success){alert(`${e.name} ì—…ë¡œë“œ ì‹¤íŒ¨: ${s.error}`);break}n(s.data)}e.target.value=""}catch(a){alert("ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{r(!1)}}},disabled:o,style:{display:"none"}})]})]})]})}function b({events:e,categories:t,onOpenSettings:s,currentDate:n}){const l=(()=>{const a={};t&&t.length>0&&t.forEach(e=>{a[e.id]={name:e.name,hours:0,color:e.color}});const s=e.filter(e=>!1===e.is_plan),l=e=>{if(!e)return new Date;const t=e.split(/[+Z]/)[0];return new Date(t)},i=new Date(n);i.setHours(0,0,0,0);const o=new Date(n);return o.setHours(23,59,59,999),s&&s.length>0&&s.forEach(e=>{const t=e.category_id;if(t&&a[t]){const s=l(e.start),n=l(e.end),r=s>i?s:i,c=n<o?n:o;if(c>r){const e=(c-r)/36e5;a[t].hours+=e}}}),a})(),i=t||[];return a.jsxs("div",{className:"category-stats-container",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{children:"ðŸ“Š ì¹´í…Œê³ ë¦¬ë³„ ì‹œê°„ (ì‹¤ì œ)"}),a.jsx("button",{className:"btn-category-settings-small",onClick:s,title:"ì¹´í…Œê³ ë¦¬ ê´€ë¦¬",children:"âš™ï¸"})]}),a.jsx("div",{className:"category-matrix-wrapper",children:a.jsxs("table",{className:"category-matrix",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{}),i.map(e=>a.jsx("th",{style:{borderBottom:`3px solid ${e.color}`,color:"#37352f"},children:e.name},e.id))]})}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"ì‹œê°„"}),i.map(e=>a.jsx("td",{style:{borderBottom:`3px solid ${e.color}`,color:"#37352f"},children:a.jsxs("span",{className:"category-time",children:[l[e.id]?l[e.id].hours.toFixed(1):"0.0","h"]})},e.id))]})})]})})]})}function S({categories:e,onCategoriesChange:s}){const[n,i]=l.useState(!1),[o,r]=l.useState(null),[c,d]=l.useState(""),[u,m]=l.useState("#16a765"),[h,p]=l.useState(""),[x,g]=l.useState(""),v=()=>{r(null),p(""),g("")};return a.jsxs("div",{className:"category-manager",children:[a.jsxs("div",{className:"category-manager-header",children:[a.jsx("h3",{children:"ì¹´í…Œê³ ë¦¬ ê´€ë¦¬"}),!n&&a.jsx("button",{className:"btn-add-category",onClick:()=>i(!0),children:"+ ì¶”ê°€"})]}),n&&a.jsxs("div",{className:"category-form",children:[a.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"ì¹´í…Œê³ ë¦¬ ì´ë¦„",className:"category-name-input"}),a.jsx("input",{type:"color",value:u,onChange:e=>m(e.target.value),className:"category-color-picker"}),a.jsxs("div",{className:"category-form-actions",children:[a.jsx("button",{className:"btn-save",onClick:async()=>{if(c.trim())try{const e=await t.createCategory(c.trim(),u);e.success?(s(),d(""),m("#16a765"),i(!1)):alert("ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì‹¤íŒ¨: "+e.error)}catch(e){alert("ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},children:"ì €ìž¥"}),a.jsx("button",{className:"btn-cancel",onClick:()=>{i(!1),d(""),m("#16a765")},children:"ì·¨ì†Œ"})]})]}),a.jsx("div",{className:"category-list",children:e&&e.length>0?e.map(e=>a.jsx("div",{className:"category-item",children:o===e.id?a.jsxs("div",{className:"category-form",children:[a.jsx("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"category-name-input"}),a.jsx("input",{type:"color",value:x,onChange:e=>g(e.target.value),className:"category-color-picker"}),a.jsxs("div",{className:"category-form-actions",children:[a.jsx("button",{className:"btn-save",onClick:()=>(async e=>{if(h.trim())try{const a=await t.updateCategory(e,{name:h.trim(),color:x});a.success?(s(),r(null),p(""),g("")):alert("ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ì‹¤íŒ¨: "+a.error)}catch(a){alert("ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}})(e.id),children:"ì €ìž¥"}),a.jsx("button",{className:"btn-cancel",onClick:v,children:"ì·¨ì†Œ"})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"category-info",children:[a.jsx("span",{className:"category-color-box",style:{backgroundColor:e.color}}),a.jsx("span",{className:"category-name",children:e.name})]}),a.jsxs("div",{className:"category-actions",children:[a.jsx("button",{className:"btn-edit",onClick:()=>{return r((t=e).id),p(t.name),void g(t.color);var t},children:"ìˆ˜ì •"}),a.jsx("button",{className:"btn-delete",onClick:()=>(async e=>{if(window.confirm("ì´ ì¹´í…Œê³ ë¦¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì‚¬ìš© ì¤‘ì¸ ì¹´í…Œê³ ë¦¬ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤)"))try{const a=await t.deleteCategory(e);a.success?s():alert("ì¹´í…Œê³ ë¦¬ ì‚­ì œ ì‹¤íŒ¨: "+a.error)}catch(a){alert("ì¹´í…Œê³ ë¦¬ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}})(e.id),children:"ì‚­ì œ"})]})]})},e.id)):a.jsx("div",{className:"no-categories",children:"ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤. ì¶”ê°€í•´ì£¼ì„¸ìš”."})})]})}function C({todoCategories:e,eventCategories:t,onAdd:s,onUpdate:n,onDelete:i}){const[o,r]=l.useState(!1),[c,d]=l.useState(""),[u,m]=l.useState(null),[h,p]=l.useState("#4a9eff"),[x,g]=l.useState(null),[v,j]=l.useState(""),[f,y]=l.useState(null),[N,b]=l.useState("#4a9eff"),S=()=>{v.trim()&&(n(x,v.trim(),f,N),g(null),j(""),y(null),b("#4a9eff"))},C=()=>{g(null),j(""),y(null)},k=e=>null==t?void 0:t.find(t=>t.id===e);return a.jsxs("div",{className:"category-manager",children:[a.jsxs("div",{className:"category-manager-header",children:[a.jsx("h3",{children:"íˆ¬ë‘ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬"}),a.jsx("button",{className:"btn-add",onClick:()=>r(!0),children:"+ ì¶”ê°€"})]}),o&&a.jsxs("div",{className:"category-edit-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì¹´í…Œê³ ë¦¬ ì´ë¦„"}),a.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"ì˜ˆ: ê°œì¸, ì—…ë¬´, í•™ìŠµ...",autoFocus:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ìƒ‰ìƒ"}),a.jsxs("div",{className:"color-picker-wrapper",style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("input",{type:"color",value:h,onChange:e=>p(e.target.value),style:{width:"40px",height:"40px",padding:"0",border:"none",cursor:"pointer"}}),a.jsx("span",{className:"color-value",style:{fontSize:"13px",color:"#666"},children:h})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì—°ê²°í•  ì´ë²¤íŠ¸ ì¹´í…Œê³ ë¦¬ (ì„ íƒ)"}),a.jsxs("select",{value:u||"",onChange:e=>m(e.target.value?parseInt(e.target.value):null),children:[a.jsx("option",{value:"",children:"-- ì„ íƒ ì•ˆ í•¨ --"}),null==t?void 0:t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"btn-save",onClick:()=>{c.trim()&&(s(c.trim(),u,h),d(""),m(null),p("#4a9eff"),r(!1))},children:"ì €ìž¥"}),a.jsx("button",{className:"btn-cancel",onClick:()=>{r(!1),d(""),m(null)},children:"ì·¨ì†Œ"})]})]}),a.jsx("div",{className:"todo-category-list",children:0===(null==e?void 0:e.length)?a.jsx("div",{className:"empty-state",children:"íˆ¬ë‘ ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤"}):null==e?void 0:e.map(e=>x===e.id?a.jsxs("div",{className:"category-edit-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì¹´í…Œê³ ë¦¬ ì´ë¦„"}),a.jsx("input",{type:"text",value:v,onChange:e=>j(e.target.value),autoFocus:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ìƒ‰ìƒ"}),a.jsxs("div",{className:"color-picker-wrapper",style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("input",{type:"color",value:N,onChange:e=>b(e.target.value),style:{width:"40px",height:"40px",padding:"0",border:"none",cursor:"pointer"}}),a.jsx("span",{className:"color-value",style:{fontSize:"13px",color:"#666"},children:N})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"ì—°ê²°í•  ì´ë²¤íŠ¸ ì¹´í…Œê³ ë¦¬"}),a.jsxs("select",{value:f||"",onChange:e=>y(e.target.value?parseInt(e.target.value):null),children:[a.jsx("option",{value:"",children:"-- ì„ íƒ ì•ˆ í•¨ --"}),null==t?void 0:t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{className:"btn-save",onClick:S,children:"ì €ìž¥"}),a.jsx("button",{className:"btn-cancel",onClick:C,children:"ì·¨ì†Œ"})]})]},e.id):a.jsxs("div",{className:"todo-category-item",children:[a.jsxs("div",{className:"todo-category-info",children:[a.jsxs("span",{className:"todo-category-name",style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("span",{className:"category-color-dot",style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:e.color||"#4a9eff",display:"inline-block"}}),e.name]}),e.event_category_id&&k(e.event_category_id)&&a.jsxs("span",{className:"linked-event-category",children:["â†’ ",k(e.event_category_id).name,a.jsx("span",{className:"category-color-dot",style:{backgroundColor:k(e.event_category_id).color}})]})]}),a.jsxs("div",{className:"category-actions",children:[a.jsx("button",{className:"btn-edit",onClick:()=>(e=>{g(e.id),j(e.name),y(e.event_category_id||null),b(e.color||"#4a9eff")})(e),children:"ìˆ˜ì •"}),a.jsx("button",{className:"btn-delete",onClick:()=>i(e.id),children:"ì‚­ì œ"})]})]},e.id))})]})}function k(e){e=e.replace(/^TZID=[^:]+:/,"");const t=parseInt(e.substring(0,4)),a=parseInt(e.substring(4,6))-1,s=parseInt(e.substring(6,8));if(8===e.length)return new Date(t,a,s);const n=parseInt(e.substring(9,11)),l=parseInt(e.substring(11,13)),i=parseInt(e.substring(13,15));return e.endsWith("Z")?new Date(Date.UTC(t,a,s,n,l,i)):new Date(t,a,s,n,l,i)}async function w(e,t="icloud"){try{if(!e)return[];const n=(s=t,(a=e).startsWith("webcal://")?a.replace(/^webcal:\/\//i,"https://"):("google"===s&&a.includes("calendar.google.com")&&a.includes("/calendar/")&&a.includes("/ical/"),"outlook"===s&&a.includes("outlook"),a)),l=`${""}/api/icloud-calendar/proxy?url=${encodeURIComponent(n)}`,i=await fetch(l);if(!i.ok)throw new Error(`Failed to fetch calendar: ${i.status}`);const o=function(e){const t=[],a=e.split(/\r?\n/);let s=null;for(let n=0;n<a.length;n++){let e=a[n].trim();for(;n+1<a.length&&/^[ \t]/.test(a[n+1]);)n++,e+=a[n].trim();if("BEGIN:VEVENT"===e)s={};else if("END:VEVENT"===e&&s)t.push(s),s=null;else if(s){const t=e.indexOf(":");if(t>0){const a=e.substring(0,t),n=e.substring(t+1);a.startsWith("DTSTART")?(s.startDate=k(n),s.isAllDay=a.includes("VALUE=DATE")&&!a.includes("TZID")):a.startsWith("DTEND")?s.endDate=k(n):"SUMMARY"===a?s.title=n:"DESCRIPTION"===a?s.description=n.replace(/\\n/g,"\n"):"LOCATION"===a?s.location=n:"UID"===a&&(s.uid=n)}}}return t}(await i.text());return o}catch(n){throw n}var a,s}function D(e){if(e.isAllDay)return"ì¢…ì¼";const t=e.startDate.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1});if(e.endDate){return`${t} - ${e.endDate.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1})}`}return t}function T({currentDate:e,onOpenSettings:t}){const[s,n]=l.useState([]),[i,o]=l.useState(!1),[r,c]=l.useState(null),[d,u]=l.useState([]),[m,h]=l.useState(()=>"true"===localStorage.getItem("hideICloudBanner"));l.useEffect(()=>{x();const e=()=>{x()};return window.addEventListener("icloud-calendar-updated",e),()=>{window.removeEventListener("icloud-calendar-updated",e)}},[e]);const p=e=>{e.stopPropagation(),h(!0),localStorage.setItem("hideICloudBanner","true")},x=async()=>{try{const t=localStorage.getItem("iCloudCalendars");if(!t)return u([]),void n([]);const a=JSON.parse(t);u(a);const s=a.filter(e=>e.enabled);if(0===s.length)return void n([]);o(!0),c(null);const l=await async function(e){try{if(!e||0===e.length)return[];const t=e.map(async e=>{try{return(await w(e.url,e.type||"icloud")).map(t=>({...t,calendarId:e.id,calendarName:e.name,calendarType:e.type||"icloud",calendarTypeIcon:e.typeIcon||"ðŸ“…",calendarColor:e.color}))}catch(r){return[]}});return(await Promise.all(t)).flat()}catch(r){throw r}}(s),i=function(e,t){const a=t.toISOString().split("T")[0];return e.filter(e=>{if(!e.startDate)return!1;const s=e.startDate.toISOString().split("T")[0];return e.isAllDay?s===a:new Date(e.startDate).toDateString()===t.toDateString()}).sort((e,t)=>e.startDate&&t.startDate?e.startDate-t.startDate:0)}(l,e);n(i)}catch(t){c("iCloud ìº˜ë¦°ë”ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),n([])}finally{o(!1)}};return 0===d.length?m?null:a.jsxs("div",{className:"icloud-events-container empty-state",children:[a.jsx("button",{className:"btn-close-banner",onClick:p,title:"ë‹«ê¸°",children:"Ã—"}),a.jsxs("div",{className:"icloud-empty-content",children:[a.jsx("div",{className:"icloud-icon-wrapper",children:a.jsx("span",{className:"icloud-icon",children:"ðŸ“…"})}),a.jsxs("p",{children:["iCloud ìº˜ë¦°ë”ë¥¼ ì—°ë™í•˜ì—¬",a.jsx("br",{}),"ì˜¤ëŠ˜ì˜ ì¼ì •ì„ í™•ì¸í•˜ì„¸ìš”"]}),a.jsx("button",{className:"btn-connect-calendar",onClick:t,children:"ìº˜ë¦°ë” êµ¬ë…í•˜ê¸°"})]})]}):i?a.jsxs("div",{className:"icloud-events-container",children:[a.jsx("h3",{className:"icloud-events-title",children:"ì˜¤ëŠ˜ì˜ ì¼ì •"}),a.jsx("div",{className:"icloud-loading",children:"ì¼ì •ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."})]}):r?a.jsxs("div",{className:"icloud-events-container",children:[a.jsx("h3",{className:"icloud-events-title",children:"ì˜¤ëŠ˜ì˜ ì¼ì •"}),a.jsx("div",{className:"icloud-error",children:r}),a.jsx("div",{className:"icloud-error-hint",children:"ìº˜ë¦°ë” URLì´ ì˜¬ë°”ë¥¸ì§€, ê³µê°œ ìº˜ë¦°ë”ë¡œ ì„¤ì •ë˜ì–´ ìžˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”."}),a.jsx("button",{className:"btn-retry-calendar",onClick:t,children:"ì„¤ì • í™•ì¸í•˜ê¸°"})]}):0===s.length?a.jsxs("div",{className:"icloud-events-container",children:[a.jsx("h3",{className:"icloud-events-title",children:"ì˜¤ëŠ˜ì˜ ì¼ì •"}),a.jsx("div",{className:"icloud-no-events",children:"ì˜¤ëŠ˜ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤."})]}):a.jsxs("div",{className:"icloud-events-container",children:[a.jsx("h3",{className:"icloud-events-title",children:"ì˜¤ëŠ˜ì˜ ì¼ì •"}),a.jsx("div",{className:"icloud-events-list",children:s.map((e,t)=>a.jsxs("div",{className:"icloud-event-item",style:{borderLeftColor:e.calendarColor||"#007bff"},children:[a.jsx("div",{className:"icloud-event-time",children:D(e)}),a.jsxs("div",{className:"icloud-event-details",children:[a.jsxs("div",{className:"icloud-event-header",children:[a.jsx("div",{className:"icloud-event-title",children:e.title||"(ì œëª© ì—†ìŒ)"}),e.calendarName&&a.jsx("span",{className:"icloud-event-calendar-badge",style:{backgroundColor:e.calendarColor||"#007bff"},children:e.calendarName})]}),e.location&&a.jsxs("div",{className:"icloud-event-location",children:["ðŸ“ ",e.location]}),e.description&&a.jsx("div",{className:"icloud-event-description",children:e.description})]})]},e.uid||t))})]})}function E({currentDate:s,setCurrentDate:n,onOpenSettings:i}){const[o,r]=l.useState(!1),[c,u]=l.useState(!1),[m,p]=l.useState([]),{dailyData:x,addTodo:f,updateTodo:k,deleteTodo:w,reorderTodos:D,updateRoutineCheck:E,addRoutine:I,updateRoutine:_,deleteRoutine:$,reorderRoutines:R,saveData:M,addImageToState:P,removeImageFromState:L}=function(a){const[s,n]=l.useState({todos:[],reflection:"",mood:null,images:[],routines:[],routineChecks:{}}),[i,o]=l.useState(!0),r=e(a),c=l.useCallback(async()=>{o(!0);try{const e=await t.getDailyData(r);e.success&&n(e.data)}catch(e){}finally{o(!1)}},[r]);return l.useEffect(()=>{c()},[c]),{dailyData:s,loading:i,saveData:l.useCallback(async e=>{n(t=>({...t,...e}));try{await t.saveDailyData(r,e)}catch(a){await c()}},[r,c]),addImageToState:l.useCallback(e=>{n(t=>({...t,images:[...t.images||[],e]}))},[]),removeImageFromState:l.useCallback(e=>{n(t=>({...t,images:(t.images||[]).filter(t=>t.id!==e)}))},[]),addTodo:l.useCallback(async(e,a,s,n,l)=>{(await t.addTodo(r,e,a,s,n,l)).success&&await c()},[r,c]),updateTodo:l.useCallback(async(e,a)=>{(await t.updateTodo(e,a)).success&&await c()},[c]),deleteTodo:l.useCallback(async e=>{(await t.deleteTodo(e)).success&&await c()},[c]),reorderTodos:l.useCallback(async e=>{(await t.reorderTodos(e)).success&&await c()},[c]),updateRoutineCheck:l.useCallback(async(e,a)=>{(await t.updateRoutineCheck(r,e,a)).success&&n(t=>({...t,routineChecks:{...t.routineChecks,[e]:a}}))},[r]),addRoutine:l.useCallback(async e=>{(await t.addRoutine(e)).success&&await c()},[c]),updateRoutine:l.useCallback(async(e,a)=>{(await t.updateRoutine(e,a)).success&&await c()},[c]),deleteRoutine:l.useCallback(async e=>{(await t.deleteRoutine(e)).success&&await c()},[c]),reorderRoutines:l.useCallback(async e=>{(await t.reorderRoutines(e)).success&&await c()},[c]),reload:c}}(s),{categories:A,events:z,loading:F,reloadCategories:O,createEvent:B,updateEvent:U,deleteEvent:q,wakeSleepInfo:Y}=function(a){const[s,n]=l.useState([]),[i,o]=l.useState([]),[r,c]=l.useState({wakeTime:"-",wakeDateTime:null,sleepTime:"-",sleepDateTime:null}),[u,m]=l.useState(!0),h=e(a),p=l.useCallback(async()=>{try{const e=await t.getCategories();e.success&&n(e.categories)}catch(e){}},[]);l.useEffect(()=>{p()},[p]);const x=l.useCallback(async()=>{const e=d.get(h);if(e&&Date.now()-e.timestamp<3e5)return o(e.events),e.wakeSleepInfo&&c({wakeTime:e.wakeSleepInfo.wakeTime||"-",wakeDateTime:e.wakeSleepInfo.wakeDateTime||null,sleepTime:e.wakeSleepInfo.sleepTime||"-",sleepDateTime:e.wakeSleepInfo.sleepDateTime||null}),void m(!1);m(!0);try{const[e,a]=await Promise.all([t.getEvents(h),t.getWakeSleepEvents(h)]);let s=[];if(e.success&&(s=e.events),a.success){const e={wakeTime:a.wakeTime||"-",wakeDateTime:a.wakeDateTime||null,sleepTime:a.sleepTime||"-",sleepDateTime:a.sleepDateTime||null};c(e)}d.set(h,{events:s,wakeSleepInfo:a.success?a:{},timestamp:Date.now()}),o(s)}catch(a){}finally{m(!1)}},[h]);l.useEffect(()=>{x()},[x]);const g=l.useCallback(async(e,a,s,n,l=!1,i="",r=null)=>{try{const c=await t.createEvent(h,e,a,s,n,l,i,r);if(c.success)return o(e=>[...e,c.event]),r&&r!==h?d.clear():d.delete(h),c.event}catch(c){throw c}},[h]),v=l.useCallback(async(e,a)=>{try{const s=await t.updateEvent(e,a);if(s.success){const t=i.find(t=>t.id===e);let n=!1;if(t&&a.date){const e=t.start?t.start.split("T")[0]:null,s=a.date;n=e&&e!==s}return n?(o(t=>t.filter(t=>t.id!==e)),d.clear()):(o(t=>t.map(t=>t.id===e?s.event:t)),d.delete(h)),s.event}}catch(s){throw s}},[h,i]),j=l.useCallback(async e=>{try{(await t.deleteEvent(e)).success&&(o(t=>t.filter(t=>t.id!==e)),d.delete(h))}catch(a){throw a}},[h]),f=l.useCallback(async()=>{d.delete(h),await x()},[h]);return{categories:s,events:i,loading:u,reload:f,reloadCategories:p,createEvent:g,updateEvent:v,deleteEvent:j,wakeSleepInfo:r}}(s),W=l.useCallback(async()=>{try{const e=await t.getTodoCategories();e.success&&p(e.data)}catch(e){}},[]);l.useEffect(()=>{W()},[W]);const K=e=>{const t=new Date(s);t.setDate(t.getDate()+e),n(t)};return a.jsxs("div",{className:"main-container",children:[a.jsxs("div",{className:"left-panel",children:[a.jsxs("div",{className:"time-tracker-date-header",children:[a.jsx("button",{className:"date-nav-btn",onClick:()=>K(-1),children:"â—€"}),a.jsx("div",{className:"current-date",children:(V=s,V.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}))}),a.jsx("button",{className:"date-nav-btn",onClick:()=>K(1),children:"â–¶"})]}),a.jsx(T,{currentDate:s,onOpenSettings:i}),a.jsx(h,{events:z,todos:x.todos,categories:A,todoCategories:m,loading:F,currentDate:s,onCreateEvent:B,onUpdateEvent:U,onDeleteEvent:q,wakeSleepInfo:Y})]}),a.jsxs("div",{className:"right-panel",children:[a.jsx(b,{events:z,categories:A,currentDate:s,onOpenSettings:()=>r(!0)}),a.jsx(v,{routines:x.routines,routineChecks:x.routineChecks,onToggle:E,onAdd:I,onUpdate:_,onDelete:$,onReorder:R}),a.jsx(g,{todos:x.todos,categories:A,todoCategories:m,currentDate:s,onAdd:f,onUpdate:k,onDelete:w,onReorder:D,onOpenTodoCategoryManager:()=>u(!0)}),a.jsx(j,{selectedMood:x.mood,onSelect:e=>M({mood:e})}),a.jsx(N,{currentDate:s,images:x.images||[],onImageUploaded:e=>{P(e)},onImageDeleted:e=>{L(e)}}),a.jsx(y,{value:x.reflection,onSave:e=>M({reflection:e})})]}),o&&a.jsx("div",{className:"modal-overlay",onClick:()=>r(!1),children:a.jsxs("div",{className:"modal-content category-manager-modal",onClick:e=>e.stopPropagation(),children:[a.jsx(S,{categories:A,onCategoriesChange:O}),a.jsx("button",{className:"btn-close-modal",onClick:()=>r(!1),children:"ë‹«ê¸°"})]})}),c&&a.jsx("div",{className:"modal-overlay",onClick:()=>u(!1),children:a.jsxs("div",{className:"modal-content category-manager-modal",onClick:e=>e.stopPropagation(),children:[a.jsx(C,{todoCategories:m,eventCategories:A,onAdd:async(e,a,s)=>{try{(await t.addTodoCategory(e,a,s)).success&&W()}catch(n){}},onUpdate:async(e,a,s,n)=>{try{(await t.updateTodoCategory(e,a,s,n)).success&&W()}catch(l){}},onDelete:async e=>{try{(await t.deleteTodoCategory(e)).success&&W()}catch(a){}}}),a.jsx("button",{className:"btn-close-modal",onClick:()=>u(!1),children:"ë‹«ê¸°"})]})})]});var V}function I({onLoginSuccess:e,onSwitchToRegister:s}){const[n,i]=l.useState(""),[o,r]=l.useState(""),[c,d]=l.useState(""),[u,m]=l.useState(!1);return a.jsxs("div",{className:"auth-container",children:[a.jsxs("div",{className:"auth-brand-section",children:[a.jsxs("div",{className:"auth-brand-graphics",children:[a.jsx("div",{className:"graphic-bg-gradient"}),a.jsxs("div",{className:"graphic-clock-face",children:[a.jsx("div",{className:"clock-hand hour-hand"}),a.jsx("div",{className:"clock-hand minute-hand"}),a.jsx("div",{className:"clock-center"})]}),a.jsxs("div",{className:"graphic-cards-container",children:[a.jsxs("div",{className:"glass-card card-top",children:[a.jsx("div",{className:"card-line"}),a.jsx("div",{className:"card-line short"})]}),a.jsxs("div",{className:"glass-card card-middle",children:[a.jsx("div",{className:"card-icon"}),a.jsx("div",{className:"card-content"})]}),a.jsxs("div",{className:"glass-card card-bottom",children:[a.jsx("div",{className:"card-chart-bar"}),a.jsx("div",{className:"card-chart-bar"}),a.jsx("div",{className:"card-chart-bar"})]})]})]}),a.jsxs("div",{className:"auth-brand-content",children:[a.jsxs("h1",{className:"auth-brand-title",children:["TimeTracker",a.jsx("br",{}),"Diary"]}),a.jsx("p",{className:"auth-brand-subtitle",children:"í•˜ë£¨ë¥¼ ê¸°ë¡í•˜ê³ , ë” ë‚˜ì€ ë‚´ì¼ì„ ê³„íší•˜ì„¸ìš”."})]})]}),a.jsx("div",{className:"auth-form-section",children:a.jsxs("div",{className:"auth-box",children:[a.jsx("h1",{className:"auth-title",children:"ë¡œê·¸ì¸"}),a.jsx("p",{className:"auth-subtitle",children:"ì„œë¹„ìŠ¤ ì´ìš©ì„ ìœ„í•´ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”."}),a.jsxs("form",{onSubmit:async a=>{a.preventDefault(),d(""),m(!0);try{const a=await t.login(n,o);a.success?e(a.user):d(a.message||"ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(s){d("ì„œë²„ì™€ ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}finally{m(!1)}},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"ì´ë©”ì¼"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:e=>i(e.target.value),placeholder:"example@email.com",required:!0,autoComplete:"email"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"ë¹„ë°€ë²ˆí˜¸"}),a.jsx("input",{type:"password",id:"password",value:o,onChange:e=>r(e.target.value),placeholder:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš”",required:!0,autoComplete:"current-password",minLength:6})]}),c&&a.jsx("div",{className:"error-message",children:c}),a.jsx("button",{type:"submit",className:"auth-button",disabled:u,children:u?"ë¡œê·¸ì¸ ì¤‘...":"ë¡œê·¸ì¸"})]}),a.jsx("div",{className:"auth-footer",children:a.jsxs("p",{children:["ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?"," ",a.jsx("button",{type:"button",onClick:s,className:"link-button",children:"íšŒì›ê°€ìž…"})]})})]})})]})}function _({onRegisterSuccess:e,onSwitchToLogin:s}){const[n,i]=l.useState(""),[o,r]=l.useState(""),[c,d]=l.useState(""),[u,m]=l.useState(""),[h,p]=l.useState(""),[x,g]=l.useState(!1);return a.jsxs("div",{className:"auth-container",children:[a.jsxs("div",{className:"auth-brand-section",children:[a.jsxs("div",{className:"auth-brand-graphics",children:[a.jsx("div",{className:"graphic-bg-gradient"}),a.jsxs("div",{className:"graphic-clock-face",children:[a.jsx("div",{className:"clock-hand hour-hand"}),a.jsx("div",{className:"clock-hand minute-hand"}),a.jsx("div",{className:"clock-center"})]}),a.jsxs("div",{className:"graphic-cards-container",children:[a.jsxs("div",{className:"glass-card card-top",children:[a.jsx("div",{className:"card-line"}),a.jsx("div",{className:"card-line short"})]}),a.jsxs("div",{className:"glass-card card-middle",children:[a.jsx("div",{className:"card-icon"}),a.jsx("div",{className:"card-content"})]}),a.jsxs("div",{className:"glass-card card-bottom",children:[a.jsx("div",{className:"card-chart-bar"}),a.jsx("div",{className:"card-chart-bar"}),a.jsx("div",{className:"card-chart-bar"})]})]})]}),a.jsxs("div",{className:"auth-brand-content",children:[a.jsxs("h1",{className:"auth-brand-title",children:["TimeTracker",a.jsx("br",{}),"Diary"]}),a.jsx("p",{className:"auth-brand-subtitle",children:"í•˜ë£¨ë¥¼ ê¸°ë¡í•˜ê³ , ë” ë‚˜ì€ ë‚´ì¼ì„ ê³„íší•˜ì„¸ìš”."})]})]}),a.jsx("div",{className:"auth-form-section",children:a.jsxs("div",{className:"auth-box",children:[a.jsx("h1",{className:"auth-title",children:"íšŒì›ê°€ìž…"}),a.jsx("p",{className:"auth-subtitle",children:"ìƒˆë¡œìš´ ê³„ì •ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”."}),a.jsxs("form",{onSubmit:async a=>{if(a.preventDefault(),p(""),o===c)if(o.length<6)p("ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 6ìž ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");else{g(!0);try{const a=await t.register(n,o,u||null);a.success?e(a.user):p(a.message||"íšŒì›ê°€ìž…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}catch(s){p("ì„œë²„ì™€ ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")}finally{g(!1)}}else p("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"ì´ë©”ì¼ *"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:e=>i(e.target.value),placeholder:"example@email.com",required:!0,autoComplete:"email"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"username",children:"ì´ë¦„ (ì„ íƒ)"}),a.jsx("input",{type:"text",id:"username",value:u,onChange:e=>m(e.target.value),placeholder:"í™ê¸¸ë™",autoComplete:"name"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"ë¹„ë°€ë²ˆí˜¸ *"}),a.jsx("input",{type:"password",id:"password",value:o,onChange:e=>r(e.target.value),placeholder:"ìµœì†Œ 6ìž ì´ìƒ",required:!0,autoComplete:"new-password",minLength:6})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"confirmPassword",children:"ë¹„ë°€ë²ˆí˜¸ í™•ì¸ *"}),a.jsx("input",{type:"password",id:"confirmPassword",value:c,onChange:e=>d(e.target.value),placeholder:"ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ìž…ë ¥í•˜ì„¸ìš”",required:!0,autoComplete:"new-password",minLength:6})]}),h&&a.jsx("div",{className:"error-message",children:h}),a.jsx("button",{type:"submit",className:"auth-button",disabled:x,children:x?"ê°€ìž… ì¤‘...":"íšŒì›ê°€ìž…"})]}),a.jsx("div",{className:"auth-footer",children:a.jsxs("p",{children:["ì´ë¯¸ ê³„ì •ì´ ìžˆìœ¼ì‹ ê°€ìš”?"," ",a.jsx("button",{type:"button",onClick:s,className:"link-button",children:"ë¡œê·¸ì¸"})]})})]})})]})}const $=["#007bff","#28a745","#dc3545","#ffc107","#17a2b8","#6f42c1","#e83e8c","#fd7e14","#20c997","#6610f2"],R=[{id:"icloud",name:"iCloud",icon:"â˜ï¸",placeholder:"webcal://..."},{id:"google",name:"Google Calendar",icon:"ðŸ“†",placeholder:"https://calendar.google.com/calendar/ical/..."},{id:"outlook",name:"Outlook",icon:"ðŸ“§",placeholder:"https://outlook.office365.com/..."},{id:"caldav",name:"CalDAV",icon:"ðŸ”—",placeholder:"https://..."},{id:"other",name:"ê¸°íƒ€ (ICS URL)",icon:"ðŸ“…",placeholder:"https://..."}];function M({onClose:e,initialSection:t="main"}){const[s,n]=l.useState(t),[i,o]=l.useState([]),[r,c]=l.useState(""),[d,u]=l.useState("icloud"),[m,h]=l.useState(""),[p,x]=l.useState($[0]),[g,v]=l.useState(!1);l.useEffect(()=>{j()},[]);const j=()=>{try{const e=localStorage.getItem("iCloudCalendars");e&&o(JSON.parse(e))}catch(e){}},f=e=>{try{localStorage.setItem("iCloudCalendars",JSON.stringify(e)),o(e),window.dispatchEvent(new Event("icloud-calendar-updated"))}catch(t){alert("ìº˜ë¦°ë” ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},y=async()=>{if(r.trim())if(m.trim()){v(!0);try{const e=R.find(e=>e.id===d),t={id:Date.now().toString(),name:r,type:d,typeIcon:(null==e?void 0:e.icon)||"ðŸ“…",url:m,color:p,enabled:!0},a=[...i,t];f(a),c(""),u("icloud"),h(""),x($[0]),alert("ìº˜ë¦°ë”ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")}catch(e){alert("ìº˜ë¦°ë” ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{v(!1)}}else alert("ìº˜ë¦°ë” URLì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.");else alert("ìº˜ë¦°ë” ì´ë¦„ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.")};return a.jsx("div",{className:"modal-overlay",onClick:e,children:a.jsxs("div",{className:"modal-content settings-modal",onClick:e=>e.stopPropagation(),children:[a.jsxs("div",{className:"settings-header",children:[a.jsxs("div",{className:"settings-header-left",children:["main"!==s&&a.jsx("button",{className:"btn-back",onClick:()=>n("main"),children:"â†"}),a.jsx("h2",{children:"main"===s?"ì„¤ì •":"ìº˜ë¦°ë” êµ¬ë…"})]}),a.jsx("button",{className:"btn-close-icon",onClick:e,children:"Ã—"})]}),a.jsx("div",{className:"settings-body",children:"main"===s?a.jsx("div",{className:"settings-list",children:a.jsxs("div",{className:"settings-item",onClick:()=>n("calendar"),children:[a.jsx("div",{className:"settings-item-icon",children:"ðŸ“…"}),a.jsxs("div",{className:"settings-item-content",children:[a.jsx("div",{className:"settings-item-title",children:"ìº˜ë¦°ë” êµ¬ë…"}),a.jsx("div",{className:"settings-item-desc",children:"iCloud ìº˜ë¦°ë” ì—°ë™ ì„¤ì •"})]}),a.jsx("div",{className:"settings-item-arrow",children:"â€º"})]})}):(()=>{const e=R.find(e=>e.id===d);return a.jsxs("div",{className:"settings-section calendar-section",children:[a.jsx("p",{className:"settings-description",children:"iCloud, Google Calendar, Outlook ë“± ë‹¤ì–‘í•œ ìº˜ë¦°ë”ë¥¼ ì¶”ê°€í•˜ì—¬ Daily Viewì—ì„œ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤."}),i.length>0&&a.jsxs("div",{className:"calendar-list",children:[a.jsx("h4",{className:"calendar-list-title",children:"êµ¬ë… ì¤‘ì¸ ìº˜ë¦°ë”"}),i.map(e=>a.jsxs("div",{className:"calendar-item",children:[a.jsxs("div",{className:"calendar-item-left",children:[a.jsx("div",{className:"calendar-color-indicator",style:{backgroundColor:e.color}}),a.jsxs("div",{className:"calendar-item-info",children:[a.jsxs("div",{className:"calendar-item-name",children:[a.jsx("span",{className:"calendar-type-icon",children:e.typeIcon||"ðŸ“…"}),e.name]}),a.jsx("div",{className:"calendar-item-url",children:e.url})]})]}),a.jsxs("div",{className:"calendar-item-actions",children:[a.jsx("button",{className:"btn-toggle-calendar "+(e.enabled?"enabled":"disabled"),onClick:()=>(e=>{const t=i.map(t=>t.id===e?{...t,enabled:!t.enabled}:t);f(t)})(e.id),title:e.enabled?"ë¹„í™œì„±í™”":"í™œì„±í™”",children:e.enabled?"âœ“":"â—‹"}),a.jsx("button",{className:"btn-delete-calendar",onClick:()=>(e=>{if(!confirm("ì´ ìº˜ë¦°ë”ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;const t=i.filter(t=>t.id!==e);f(t)})(e.id),title:"ì‚­ì œ",children:"Ã—"})]})]},e.id))]}),a.jsxs("div",{className:"add-calendar-form",children:[a.jsx("h4",{className:"form-title",children:"ìƒˆ ìº˜ë¦°ë” ì¶”ê°€"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"ìº˜ë¦°ë” ì¢…ë¥˜"}),a.jsx("div",{className:"calendar-type-selector",children:R.map(e=>a.jsxs("button",{className:"type-option "+(d===e.id?"selected":""),onClick:()=>u(e.id),type:"button",children:[a.jsx("span",{className:"type-icon",children:e.icon}),a.jsx("span",{className:"type-name",children:e.name})]},e.id))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"ìº˜ë¦°ë” ì´ë¦„"}),a.jsx("input",{type:"text",className:"form-input",placeholder:"ì˜ˆ: ê°œì¸ ì¼ì •",value:r,onChange:e=>c(e.target.value)})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"ìº˜ë¦°ë” URL"}),a.jsx("input",{type:"text",className:"form-input",placeholder:(null==e?void 0:e.placeholder)||"https://...",value:m,onChange:e=>h(e.target.value)})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"form-label",children:"ìƒ‰ìƒ ì„ íƒ"}),a.jsx("div",{className:"color-picker",children:$.map(e=>a.jsx("button",{className:"color-option "+(p===e?"selected":""),style:{backgroundColor:e},onClick:()=>x(e)},e))})]}),a.jsx("button",{className:"btn-add-calendar",onClick:y,disabled:g,children:g?"ì¶”ê°€ ì¤‘...":"+ ìº˜ë¦°ë” ì¶”ê°€"})]}),a.jsxs("div",{className:"settings-help-card",children:[a.jsx("h4",{children:"ðŸ’¡ ìº˜ë¦°ë” URL ì°¾ëŠ” ë°©ë²•"}),a.jsxs("div",{className:"help-section",children:[a.jsx("strong",{children:"â˜ï¸ iCloud:"}),a.jsxs("ol",{children:[a.jsx("li",{children:"iCloud.comì— ë¡œê·¸ì¸í•˜ì—¬ ìº˜ë¦°ë” ì•±ì„ ì—½ë‹ˆë‹¤."}),a.jsx("li",{children:"ê³µìœ í•  ìº˜ë¦°ë” ì˜†ì˜ ê³µìœ  ì•„ì´ì½˜ì„ í´ë¦­í•©ë‹ˆë‹¤."}),a.jsx("li",{children:'"ê³µê°œ ìº˜ë¦°ë”"ë¥¼ ì²´í¬í•˜ê³  URLì„ ë³µì‚¬í•©ë‹ˆë‹¤.'})]})]}),a.jsxs("div",{className:"help-section",children:[a.jsx("strong",{children:"ðŸ“† Google Calendar:"}),a.jsxs("ol",{children:[a.jsx("li",{children:"Google Calendar ì„¤ì •ì—ì„œ í†µí•© ì„¹ì…˜ì„ ì°¾ìŠµë‹ˆë‹¤."}),a.jsx("li",{children:'"ë¹„ê³µê°œ ì£¼ì†Œ (iCal í˜•ì‹)" URLì„ ë³µì‚¬í•©ë‹ˆë‹¤.'})]})]}),a.jsxs("div",{className:"help-section",children:[a.jsx("strong",{children:"ðŸ“§ Outlook:"}),a.jsxs("ol",{children:[a.jsx("li",{children:'Outlook ìº˜ë¦°ë” ì„¤ì •ì—ì„œ "ê²Œì‹œ" ë˜ëŠ” "ê³µìœ "ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.'}),a.jsx("li",{children:"ICS í˜•ì‹ì˜ URLì„ ë³µì‚¬í•©ë‹ˆë‹¤."})]})]})]})]})})()})]})})}const P=l.lazy(()=>function(e,t){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in c)return;c[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,s&&n.setAttribute("nonce",s),document.head.appendChild(n),t?new Promise((t,a)=>{n.addEventListener("load",t),n.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})}(()=>import("./monthly-BKqw5b9R.js").then(e=>e.M),__vite__mapDeps([0,1])));function L(){const[e,s]=l.useState(()=>localStorage.getItem("currentView")||"daily"),[n,i]=l.useState(()=>{const e=localStorage.getItem("currentDate");return e?new Date(e):new Date}),[o,r]=l.useState(null),[c,d]=l.useState("login"),[u,m]=l.useState(!0),[h,p]=l.useState(!1),[x,g]=l.useState("main"),v=(e="main")=>{g(e),p(!0)};l.useEffect(()=>{localStorage.setItem("currentView",e)},[e]),l.useEffect(()=>{localStorage.setItem("currentDate",n.toISOString())},[n]),l.useEffect(()=>{(async()=>{try{const e=await t.getCurrentUser();e.success&&r(e.user)}catch(e){}finally{m(!1)}})()},[]);const j=e=>{s(e)},f=e=>{r(e)},y=e=>{r(e)};return u?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",fontSize:"18px",color:"#666"},children:"ë¡œë”© ì¤‘..."}):o?a.jsxs("div",{className:"App",children:[a.jsxs("div",{className:"header",children:[a.jsx("div",{className:"header-title",children:"TimeTracker Diary"}),a.jsxs("div",{className:"header-actions",children:[a.jsxs("div",{className:"date-selector",children:[a.jsx("button",{className:"date-nav-btn view-toggle-btn "+("daily"===e?"active":""),onClick:()=>j("daily"),children:"Daily"}),a.jsx("button",{className:"date-nav-btn view-toggle-btn "+("monthly"===e?"active":""),onClick:()=>j("monthly"),children:"Monthly"}),a.jsx("button",{className:"date-nav-btn settings-btn",onClick:()=>v("main"),title:"ì„¤ì •",children:"âš™ï¸"})]}),a.jsxs("div",{className:"user-info",children:[a.jsx("span",{className:"user-email",children:o.email}),a.jsx("button",{className:"logout-btn",onClick:async()=>{try{await t.logout(),r(null)}catch(e){}},children:"ë¡œê·¸ì•„ì›ƒ"})]})]})]}),a.jsx("div",{className:"view-container "+("daily"===e?"active":""),children:"daily"===e&&a.jsx(E,{currentDate:n,setCurrentDate:i,onOpenSettings:()=>v("calendar")})}),a.jsx("div",{className:"view-container "+("monthly"===e?"active":""),children:"monthly"===e&&a.jsx(l.Suspense,{fallback:a.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"ë¡œë”© ì¤‘..."}),children:a.jsx(P,{goToDate:e=>{const[t,a,n]=e.split("-").map(Number);i(new Date(t,a-1,n)),s("daily")}})})}),h&&a.jsx(M,{onClose:()=>p(!1),initialSection:x})]}):"login"===c?a.jsx(I,{onLoginSuccess:f,onSwitchToRegister:()=>d("register")}):a.jsx(_,{onRegisterSuccess:y,onSwitchToLogin:()=>d("login")})}o.createRoot(document.getElementById("root")).render(a.jsx(i.StrictMode,{children:a.jsx(L,{})}));
